/*! office-add-in-microsoft-graph-react v.1.0.0 (1595992459565) Â©  */!function(e){var t={};function r(n){if(t[n])return t[n].exports;var o=t[n]={i:n,l:!1,exports:{}};return e[n].call(o.exports,o,o.exports,r),o.l=!0,o.exports}r.m=e,r.c=t,r.d=function(e,t,n){r.o(e,t)||Object.defineProperty(e,t,{enumerable:!0,get:n})},r.r=function(e){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},r.t=function(e,t){if(1&t&&(e=r(e)),8&t)return e;if(4&t&&"object"==typeof e&&e&&e.__esModule)return e;var n=Object.create(null);if(r.r(n),Object.defineProperty(n,"default",{enumerable:!0,value:e}),2&t&&"string"!=typeof e)for(var o in e)r.d(n,o,function(t){return e[t]}.bind(null,o));return n},r.n=function(e){var t=e&&e.__esModule?function(){return e.default}:function(){return e};return r.d(t,"a",t),t},r.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},r.p="./",r(r.s=210)}({1:function(e,t,r){"use strict";r.d(t,"d",(function(){return o})),r.d(t,"a",(function(){return i})),r.d(t,"f",(function(){return a})),r.d(t,"c",(function(){return s})),r.d(t,"b",(function(){return c})),r.d(t,"e",(function(){return u})),r.d(t,"g",(function(){return l}));
/*! *****************************************************************************
Copyright (c) Microsoft Corporation.

Permission to use, copy, modify, and/or distribute this software for any
purpose with or without fee is hereby granted.

THE SOFTWARE IS PROVIDED "AS IS" AND THE AUTHOR DISCLAIMS ALL WARRANTIES WITH
REGARD TO THIS SOFTWARE INCLUDING ALL IMPLIED WARRANTIES OF MERCHANTABILITY
AND FITNESS. IN NO EVENT SHALL THE AUTHOR BE LIABLE FOR ANY SPECIAL, DIRECT,
INDIRECT, OR CONSEQUENTIAL DAMAGES OR ANY DAMAGES WHATSOEVER RESULTING FROM
LOSS OF USE, DATA OR PROFITS, WHETHER IN AN ACTION OF CONTRACT, NEGLIGENCE OR
OTHER TORTIOUS ACTION, ARISING OUT OF OR IN CONNECTION WITH THE USE OR
PERFORMANCE OF THIS SOFTWARE.
***************************************************************************** */
var n=function(e,t){return(n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var r in t)t.hasOwnProperty(r)&&(e[r]=t[r])})(e,t)};function o(e,t){function r(){this.constructor=e}n(e,t),e.prototype=null===t?Object.create(t):(r.prototype=t.prototype,new r)}var i=function(){return(i=Object.assign||function(e){for(var t,r=1,n=arguments.length;r<n;r++)for(var o in t=arguments[r])Object.prototype.hasOwnProperty.call(t,o)&&(e[o]=t[o]);return e}).apply(this,arguments)};function a(e,t){var r={};for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&t.indexOf(n)<0&&(r[n]=e[n]);if(null!=e&&"function"==typeof Object.getOwnPropertySymbols){var o=0;for(n=Object.getOwnPropertySymbols(e);o<n.length;o++)t.indexOf(n[o])<0&&Object.prototype.propertyIsEnumerable.call(e,n[o])&&(r[n[o]]=e[n[o]])}return r}function s(e,t,r,n){var o,i=arguments.length,a=i<3?t:null===n?n=Object.getOwnPropertyDescriptor(t,r):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)a=Reflect.decorate(e,t,r,n);else for(var s=e.length-1;s>=0;s--)(o=e[s])&&(a=(i<3?o(a):i>3?o(t,r,a):o(t,r))||a);return i>3&&a&&Object.defineProperty(t,r,a),a}function c(e,t,r,n){return new(r||(r=Promise))((function(o,i){function a(e){try{c(n.next(e))}catch(e){i(e)}}function s(e){try{c(n.throw(e))}catch(e){i(e)}}function c(e){var t;e.done?o(e.value):(t=e.value,t instanceof r?t:new r((function(e){e(t)}))).then(a,s)}c((n=n.apply(e,t||[])).next())}))}function u(e,t){var r,n,o,i,a={label:0,sent:function(){if(1&o[0])throw o[1];return o[1]},trys:[],ops:[]};return i={next:s(0),throw:s(1),return:s(2)},"function"==typeof Symbol&&(i[Symbol.iterator]=function(){return this}),i;function s(i){return function(s){return function(i){if(r)throw new TypeError("Generator is already executing.");for(;a;)try{if(r=1,n&&(o=2&i[0]?n.return:i[0]?n.throw||((o=n.return)&&o.call(n),0):n.next)&&!(o=o.call(n,i[1])).done)return o;switch(n=0,o&&(i=[2&i[0],o.value]),i[0]){case 0:case 1:o=i;break;case 4:return a.label++,{value:i[1],done:!1};case 5:a.label++,n=i[1],i=[0];continue;case 7:i=a.ops.pop(),a.trys.pop();continue;default:if(!(o=a.trys,(o=o.length>0&&o[o.length-1])||6!==i[0]&&2!==i[0])){a=0;continue}if(3===i[0]&&(!o||i[1]>o[0]&&i[1]<o[3])){a.label=i[1];break}if(6===i[0]&&a.label<o[1]){a.label=o[1],o=i;break}if(o&&a.label<o[2]){a.label=o[2],a.ops.push(i);break}o[2]&&a.ops.pop(),a.trys.pop();continue}i=t.call(e,a)}catch(e){i=[6,e],n=0}finally{r=o=0}if(5&i[0])throw i[1];return{value:i[0]?i[1]:void 0,done:!0}}([i,s])}}}function l(){for(var e=0,t=0,r=arguments.length;t<r;t++)e+=arguments[t].length;var n=Array(e),o=0;for(t=0;t<r;t++)for(var i=arguments[t],a=0,s=i.length;a<s;a++,o++)n[o]=i[a];return n}},210:function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n=r(86),o=r(85);Office.initialize=function(){var e={auth:{clientId:"94f86dde-17e3-4ee1-964e-47120d3f8f5c",authority:"https://login.microsoftonline.com/common",redirectUri:"https://"+o.hostname+"/login/login.html"},cache:{cacheLocation:"localStorage",storeAuthStateInCookie:!0}};console.log("hostname: "+o.hostname);var t=new n.UserAgentApplication(e);t.handleRedirectCallback((function(e,t){if(e){var r="errorMessage: "+e.errorCode+"\n                                   message: "+e.errorMessage+"\n                                   errorCode: "+e.stack;Office.context.ui.messageParent(JSON.stringify({status:"failure",result:r}))}else"id_token"===t.tokenType?localStorage.setItem("loggedIn","yes"):Office.context.ui.messageParent(JSON.stringify({status:"success",result:t.accessToken}))}));var r={scopes:["user.read","files.read.all"]};"yes"===localStorage.getItem("loggedIn")?t.acquireTokenRedirect(r):t.loginRedirect(r)}},85:function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.hostname=void 0,t.hostname=window.location.host+"/app"},86:function(e,t,r){"use strict";r.r(t),r.d(t,"UserAgentApplication",(function(){return Lt})),r.d(t,"Logger",(function(){return Ne})),r.d(t,"LogLevel",(function(){return Oe})),r.d(t,"Account",(function(){return Se})),r.d(t,"Constants",(function(){return u})),r.d(t,"ServerHashParamKeys",(function(){return n})),r.d(t,"Authority",(function(){return _e})),r.d(t,"CryptoUtils",(function(){return c})),r.d(t,"UrlUtils",(function(){return de})),r.d(t,"WindowUtils",(function(){return Ce})),r.d(t,"AuthError",(function(){return b})),r.d(t,"ClientAuthError",(function(){return G})),r.d(t,"ServerError",(function(){return je})),r.d(t,"ClientConfigurationError",(function(){return le})),r.d(t,"InteractionRequiredAuthError",(function(){return Ge}));var n,o,i,a,s=r(1),c=function(){function e(){}return e.createNewGuid=function(){var t=window.crypto;if(t&&t.getRandomValues){var r=new Uint8Array(16);return t.getRandomValues(r),r[6]|=64,r[6]&=79,r[8]|=128,r[8]&=191,e.decimalToHex(r[0])+e.decimalToHex(r[1])+e.decimalToHex(r[2])+e.decimalToHex(r[3])+"-"+e.decimalToHex(r[4])+e.decimalToHex(r[5])+"-"+e.decimalToHex(r[6])+e.decimalToHex(r[7])+"-"+e.decimalToHex(r[8])+e.decimalToHex(r[9])+"-"+e.decimalToHex(r[10])+e.decimalToHex(r[11])+e.decimalToHex(r[12])+e.decimalToHex(r[13])+e.decimalToHex(r[14])+e.decimalToHex(r[15])}for(var n="xxxxxxxx-xxxx-4xxx-yxxx-xxxxxxxxxxxx",o="0123456789abcdef",i=0,a="",s=0;s<36;s++)"-"!==n[s]&&"4"!==n[s]&&(i=16*Math.random()|0),"x"===n[s]?a+=o[i]:"y"===n[s]?(i&=3,a+=o[i|=8]):a+=n[s];return a},e.isGuid=function(e){return/^[0-9a-f]{8}-[0-9a-f]{4}-[1-5][0-9a-f]{3}-[89ab][0-9a-f]{3}-[0-9a-f]{12}$/i.test(e)},e.decimalToHex=function(e){for(var t=e.toString(16);t.length<2;)t="0"+t;return t},e.base64Encode=function(e){return btoa(encodeURIComponent(e).replace(/%([0-9A-F]{2})/g,(function(e,t){return String.fromCharCode(Number("0x"+t))})))},e.base64Decode=function(e){var t=e.replace(/-/g,"+").replace(/_/g,"/");switch(t.length%4){case 0:break;case 2:t+="==";break;case 3:t+="=";break;default:throw new Error("Invalid base64 string")}return decodeURIComponent(atob(t).split("").map((function(e){return"%"+("00"+e.charCodeAt(0).toString(16)).slice(-2)})).join(""))},e.deserialize=function(e){var t,r=/\+/g,n=/([^&=]+)=([^&]*)/g,o=function(e){return decodeURIComponent(decodeURIComponent(e.replace(r," ")))},i={};for(t=n.exec(e);t;)i[o(t[1])]=o(t[2]),t=n.exec(e);return i},e}(),u=function(){function e(){}return Object.defineProperty(e,"libraryName",{get:function(){return"Msal.js"},enumerable:!0,configurable:!0}),Object.defineProperty(e,"claims",{get:function(){return"claims"},enumerable:!0,configurable:!0}),Object.defineProperty(e,"clientId",{get:function(){return"clientId"},enumerable:!0,configurable:!0}),Object.defineProperty(e,"adalIdToken",{get:function(){return"adal.idtoken"},enumerable:!0,configurable:!0}),Object.defineProperty(e,"cachePrefix",{get:function(){return"msal"},enumerable:!0,configurable:!0}),Object.defineProperty(e,"scopes",{get:function(){return"scopes"},enumerable:!0,configurable:!0}),Object.defineProperty(e,"no_account",{get:function(){return"NO_ACCOUNT"},enumerable:!0,configurable:!0}),Object.defineProperty(e,"upn",{get:function(){return"upn"},enumerable:!0,configurable:!0}),Object.defineProperty(e,"domain_hint",{get:function(){return"domain_hint"},enumerable:!0,configurable:!0}),Object.defineProperty(e,"prompt_select_account",{get:function(){return"&prompt=select_account"},enumerable:!0,configurable:!0}),Object.defineProperty(e,"prompt_none",{get:function(){return"&prompt=none"},enumerable:!0,configurable:!0}),Object.defineProperty(e,"prompt",{get:function(){return"prompt"},enumerable:!0,configurable:!0}),Object.defineProperty(e,"response_mode_fragment",{get:function(){return"&response_mode=fragment"},enumerable:!0,configurable:!0}),Object.defineProperty(e,"resourceDelimiter",{get:function(){return"|"},enumerable:!0,configurable:!0}),Object.defineProperty(e,"cacheDelimiter",{get:function(){return"."},enumerable:!0,configurable:!0}),Object.defineProperty(e,"popUpWidth",{get:function(){return this._popUpWidth},set:function(e){this._popUpWidth=e},enumerable:!0,configurable:!0}),Object.defineProperty(e,"popUpHeight",{get:function(){return this._popUpHeight},set:function(e){this._popUpHeight=e},enumerable:!0,configurable:!0}),Object.defineProperty(e,"login",{get:function(){return"LOGIN"},enumerable:!0,configurable:!0}),Object.defineProperty(e,"renewToken",{get:function(){return"RENEW_TOKEN"},enumerable:!0,configurable:!0}),Object.defineProperty(e,"unknown",{get:function(){return"UNKNOWN"},enumerable:!0,configurable:!0}),Object.defineProperty(e,"ADFS",{get:function(){return"adfs"},enumerable:!0,configurable:!0}),Object.defineProperty(e,"homeAccountIdentifier",{get:function(){return"homeAccountIdentifier"},enumerable:!0,configurable:!0}),Object.defineProperty(e,"common",{get:function(){return"common"},enumerable:!0,configurable:!0}),Object.defineProperty(e,"openidScope",{get:function(){return"openid"},enumerable:!0,configurable:!0}),Object.defineProperty(e,"profileScope",{get:function(){return"profile"},enumerable:!0,configurable:!0}),Object.defineProperty(e,"interactionTypeRedirect",{get:function(){return"redirectInteraction"},enumerable:!0,configurable:!0}),Object.defineProperty(e,"interactionTypePopup",{get:function(){return"popupInteraction"},enumerable:!0,configurable:!0}),Object.defineProperty(e,"interactionTypeSilent",{get:function(){return"silentInteraction"},enumerable:!0,configurable:!0}),Object.defineProperty(e,"inProgress",{get:function(){return"inProgress"},enumerable:!0,configurable:!0}),e._popUpWidth=483,e._popUpHeight=600,e}();!function(e){e.SCOPE="scope",e.STATE="state",e.ERROR="error",e.ERROR_DESCRIPTION="error_description",e.ACCESS_TOKEN="access_token",e.ID_TOKEN="id_token",e.EXPIRES_IN="expires_in",e.SESSION_STATE="session_state",e.CLIENT_INFO="client_info"}(n||(n={})),function(e){e.AUTHORITY="authority",e.ACQUIRE_TOKEN_ACCOUNT="acquireTokenAccount",e.SESSION_STATE="session.state",e.STATE_LOGIN="state.login",e.STATE_ACQ_TOKEN="state.acquireToken",e.STATE_RENEW="state.renew",e.NONCE_IDTOKEN="nonce.idtoken",e.LOGIN_REQUEST="login.request",e.RENEW_STATUS="token.renew.status",e.URL_HASH="urlHash",e.INTERACTION_STATUS="interaction_status",e.REDIRECT_REQUEST="redirect_request"}(o||(o={})),function(e){e.IDTOKEN="idtoken",e.CLIENT_INFO="client.info"}(i||(i={})),function(e){e.LOGIN_ERROR="login.error",e.ERROR="error",e.ERROR_DESC="error.description"}(a||(a={}));var l;!function(e){e.ACCOUNT="account",e.SID="sid",e.LOGIN_HINT="login_hint",e.ID_TOKEN="id_token",e.ACCOUNT_ID="accountIdentifier",e.HOMEACCOUNT_ID="homeAccountIdentifier"}(l||(l={}));var h=[l.SID,l.LOGIN_HINT],d="GET",p={LOGIN:"login",SELECT_ACCOUNT:"select_account",CONSENT:"consent",NONE:"none"},g="msalIdTokenFrame",f="msalRenewFrame";var m,y={code:"unexpected_error",desc:"Unexpected error in authentication."},v={code:"no_window_object",desc:"No window object available. Details:"},b=function(e){function t(r,n){var o=e.call(this,n)||this;return Object.setPrototypeOf(o,t.prototype),o.errorCode=r,o.errorMessage=n,o.name="AuthError",o}return s.d(t,e),t.createUnexpectedError=function(e){return new t(y.code,y.desc+": "+e)},t.createNoWindowObjectError=function(e){return new t(v.code,v.desc+" "+e)},t}(Error),I=function(){function e(){}return e.isEmpty=function(e){return void 0===e||!e||0===e.length},e}(),w={code:"multiple_matching_tokens",desc:"The cache contains multiple tokens satisfying the requirements. Call AcquireToken again providing more requirements like authority."},T={code:"multiple_authorities",desc:"Multiple authorities found in the cache. Pass authority in the API overload."},E={code:"endpoints_resolution_error",desc:"Error: could not resolve endpoints. Please check network and try again."},S={code:"popup_window_error",desc:"Error opening popup window. This can happen if you are using IE or if popups are blocked in the browser."},C={code:"token_renewal_error",desc:"Token renewal operation failed due to timeout."},k={code:"invalid_id_token",desc:"Invalid ID token format."},A={code:"invalid_state_error",desc:"Invalid state."},R={code:"nonce_mismatch_error",desc:"Nonce is not matching, Nonce received: "},O={code:"login_progress_error",desc:"Login_In_Progress: Error during login call - login is already in progress."},_={code:"acquiretoken_progress_error",desc:"AcquireToken_In_Progress: Error during login call - login is already in progress."},P={code:"user_cancelled",desc:"User cancelled the flow."},N={code:"callback_error",desc:"Error occurred in token received callback function."},L={code:"user_login_error",desc:"User login is required. For silent calls, request must contain either sid or login_hint"},U={code:"user_non_existent",desc:"User object does not exist. Please call a login API."},q={code:"client_info_decoding_error",desc:"The client info could not be parsed/decoded correctly. Please review the trace to determine the root cause."},x={code:"client_info_not_populated_error",desc:"The service did not populate client_info in the response, Please verify with the service team"},M={code:"null_or_empty_id_token",desc:"The idToken is null or empty. Please review the trace to determine the root cause."},H={code:"id_token_parsing_error",desc:"ID token cannot be parsed. Please review stack trace to determine root cause."},j={code:"token_encoding_error",desc:"The token to be decoded is not encoded correctly."},D={code:"invalid_interaction_type",desc:"The interaction type passed to the handler was incorrect or unknown"},F={code:"cannot_parse_cache",desc:"The cached token key is not a valid JSON and cannot be parsed"},K={code:"block_token_requests",desc:"Token calls are blocked in hidden iframes"},G=function(e){function t(r,n){var o=e.call(this,r,n)||this;return o.name="ClientAuthError",Object.setPrototypeOf(o,t.prototype),o}return s.d(t,e),t.createEndpointResolutionError=function(e){var r=E.desc;return e&&!I.isEmpty(e)&&(r+=" Details: "+e),new t(E.code,r)},t.createMultipleMatchingTokensInCacheError=function(e){return new t(w.code,"Cache error for scope "+e+": "+w.desc+".")},t.createMultipleAuthoritiesInCacheError=function(e){return new t(T.code,"Cache error for scope "+e+": "+T.desc+".")},t.createPopupWindowError=function(e){var r=S.desc;return e&&!I.isEmpty(e)&&(r+=" Details: "+e),new t(S.code,r)},t.createTokenRenewalTimeoutError=function(){return new t(C.code,C.desc)},t.createInvalidIdTokenError=function(e){return new t(k.code,k.desc+" Given token: "+e)},t.createInvalidStateError=function(e,r){return new t(A.code,A.desc+" "+e+", state expected : "+r+".")},t.createNonceMismatchError=function(e,r){return new t(R.code,R.desc+" "+e+", nonce expected : "+r+".")},t.createLoginInProgressError=function(){return new t(O.code,O.desc)},t.createAcquireTokenInProgressError=function(){return new t(_.code,_.desc)},t.createUserCancelledError=function(){return new t(P.code,P.desc)},t.createErrorInCallbackFunction=function(e){return new t(N.code,N.desc+" "+e+".")},t.createUserLoginRequiredError=function(){return new t(L.code,L.desc)},t.createUserDoesNotExistError=function(){return new t(U.code,U.desc)},t.createClientInfoDecodingError=function(e){return new t(q.code,q.desc+" Failed with error: "+e)},t.createClientInfoNotPopulatedError=function(e){return new t(x.code,x.desc+" Failed with error: "+e)},t.createIdTokenNullOrEmptyError=function(e){return new t(M.code,M.desc+" Raw ID Token Value: "+e)},t.createIdTokenParsingError=function(e){return new t(H.code,H.desc+" Failed with error: "+e)},t.createTokenEncodingError=function(e){return new t(j.code,j.desc+" Attempted to decode: "+e)},t.createInvalidInteractionTypeError=function(){return new t(D.code,D.desc)},t.createCacheParseError=function(e){var r="invalid key: "+e+", "+F.desc;return new t(F.code,r)},t.createBlockTokenRequestsInHiddenIframeError=function(){return new t(K.code,K.desc)},t}(b),W={code:"no_config_set",desc:"Configuration has not been set. Please call the UserAgentApplication constructor with a valid Configuration object."},Q={code:"storage_not_supported",desc:"The value for the cacheLocation is not supported."},V={code:"no_redirect_callbacks",desc:"No redirect callbacks have been set. Please call handleRedirectCallback() with the appropriate function arguments before continuing. More information is available here: https://github.com/AzureAD/microsoft-authentication-library-for-js/wiki/MSAL-basics."},J={code:"invalid_callback_object",desc:"The object passed for the callback was invalid. More information is available here: https://github.com/AzureAD/microsoft-authentication-library-for-js/wiki/MSAL-basics."},z={code:"scopes_required",desc:"Scopes are required to obtain an access token."},B={code:"empty_input_scopes_error",desc:"Scopes cannot be passed as empty array."},X={code:"nonarray_input_scopes_error",desc:"Scopes cannot be passed as non-array."},Y={code:"clientid_input_scopes_error",desc:"Client ID can only be provided as a single scope."},$={code:"invalid_prompt_value",desc:"Supported prompt values are 'login', 'select_account', 'consent' and 'none'"},Z={code:"invalid_authority_type",desc:"The given authority is not a valid type of authority supported by MSAL. Please see here for valid authorities: <insert URL here>."},ee={code:"authority_uri_insecure",desc:"Authority URIs must use https."},te={code:"authority_uri_invalid_path",desc:"Given authority URI is invalid."},re={code:"untrusted_authority",desc:"The provided authority is not a trusted authority. Please include this authority in the knownAuthorities config parameter or set validateAuthority=false."},ne={code:"b2c_known_authorities_not_set",desc:"Must set known authorities when validateAuthority is set to True and using B2C"},oe={code:"claims_request_parsing_error",desc:"Could not parse the given claims request object."},ie={code:"empty_request_error",desc:"Request object is required."},ae={code:"invalid_guid_sent_as_correlationId",desc:"Please set the correlationId as a valid guid"},se={code:"telemetry_config_error",desc:"Telemetry config is not configured with required values"},ce={code:"sso_silent_error",desc:"request must contain either sid or login_hint"},ue={code:"authority_metadata_error",desc:"Invalid authorityMetadata. Must be a JSON object containing authorization_endpoint, end_session_endpoint, and issuer fields."},le=function(e){function t(r,n){var o=e.call(this,r,n)||this;return o.name="ClientConfigurationError",Object.setPrototypeOf(o,t.prototype),o}return s.d(t,e),t.createNoSetConfigurationError=function(){return new t(W.code,""+W.desc)},t.createStorageNotSupportedError=function(e){return new t(Q.code,Q.desc+" Given location: "+e)},t.createRedirectCallbacksNotSetError=function(){return new t(V.code,V.desc)},t.createInvalidCallbackObjectError=function(e){return new t(J.code,J.desc+" Given value for callback function: "+e)},t.createEmptyScopesArrayError=function(e){return new t(B.code,B.desc+" Given value: "+e+".")},t.createScopesNonArrayError=function(e){return new t(X.code,X.desc+" Given value: "+e+".")},t.createClientIdSingleScopeError=function(e){return new t(Y.code,Y.desc+" Given value: "+e+".")},t.createScopesRequiredError=function(e){return new t(z.code,z.desc+" Given value: "+e)},t.createInvalidPromptError=function(e){return new t($.code,$.desc+" Given value: "+e)},t.createClaimsRequestParsingError=function(e){return new t(oe.code,oe.desc+" Given value: "+e)},t.createEmptyRequestError=function(){var e=ie;return new t(e.code,e.desc)},t.createInvalidCorrelationIdError=function(){return new t(ae.code,ae.desc)},t.createKnownAuthoritiesNotSetError=function(){return new t(ne.code,ne.desc)},t.createInvalidAuthorityTypeError=function(){return new t(Z.code,Z.desc)},t.createUntrustedAuthorityError=function(e){return new t(re.code,re.desc+" Provided Authority: "+e)},t.createTelemetryConfigError=function(e){var r=se,n=r.code,o=r.desc,i={applicationName:"string",applicationVersion:"string",telemetryEmitter:"function"};return new t(n,o+" mising values: "+Object.keys(i).reduce((function(t,r){return e[r]?t:t.concat([r+" ("+i[r]+")"])}),[]).join(","))},t.createSsoSilentError=function(){return new t(ce.code,ce.desc)},t.createInvalidAuthorityMetadataError=function(){return new t(ue.code,ue.desc)},t}(G),he=function(){function e(){}return e.isIntersectingScopes=function(e,t){for(var r=this.trimAndConvertArrayToLowerCase(e.slice()),n=this.trimAndConvertArrayToLowerCase(t.slice()),o=0;o<n.length;o++)if(r.indexOf(n[o].toLowerCase())>-1)return!0;return!1},e.containsScope=function(e,t){var r=this.trimAndConvertArrayToLowerCase(e.slice());return this.trimAndConvertArrayToLowerCase(t.slice()).every((function(e){return r.indexOf(e.toString().toLowerCase())>=0}))},e.trimAndConvertToLowerCase=function(e){return e.trim().toLowerCase()},e.trimAndConvertArrayToLowerCase=function(e){var t=this;return e.map((function(e){return t.trimAndConvertToLowerCase(e)}))},e.removeElement=function(e,t){var r=this.trimAndConvertToLowerCase(t);return e.filter((function(e){return e!==r}))},e.parseScope=function(e){var t="";if(e)for(var r=0;r<e.length;++r)t+=r!==e.length-1?e[r]+" ":e[r];return t},e.validateInputScope=function(e,t,r){if(e){if(!Array.isArray(e))throw le.createScopesNonArrayError(e);if(e.length<1)throw le.createEmptyScopesArrayError(e.toString());if(e.indexOf(r)>-1&&e.length>1)throw le.createClientIdSingleScopeError(e.toString())}else if(t)throw le.createScopesRequiredError(e)},e.getScopeFromState=function(e){if(e){var t=e.indexOf(u.resourceDelimiter);if(t>-1&&t+1<e.length)return e.substring(t+1)}return""},e.appendScopes=function(e,t){if(e){var r=t?this.trimAndConvertArrayToLowerCase(t.slice()):null,n=this.trimAndConvertArrayToLowerCase(e.slice());return r?n.concat(r):n}return null},e}(),de=function(){function e(){}return e.createNavigateUrl=function(e){var t=this.createNavigationUrlString(e),r=e.authorityInstance.AuthorizationEndpoint;return r.indexOf("?")<0?r+="?":r+="&",""+r+t.join("&")},e.createNavigationUrlString=function(e){var t=e.scopes;-1===t.indexOf(e.clientId)&&t.push(e.clientId);var r=[];return r.push("response_type="+e.responseType),this.translateclientIdUsedInScope(t,e.clientId),r.push("scope="+encodeURIComponent(he.parseScope(t))),r.push("client_id="+encodeURIComponent(e.clientId)),r.push("redirect_uri="+encodeURIComponent(e.redirectUri)),r.push("state="+encodeURIComponent(e.state)),r.push("nonce="+encodeURIComponent(e.nonce)),r.push("client_info=1"),r.push("x-client-SKU="+e.xClientSku),r.push("x-client-Ver="+e.xClientVer),e.promptValue&&r.push("prompt="+encodeURIComponent(e.promptValue)),e.claimsValue&&r.push("claims="+encodeURIComponent(e.claimsValue)),e.queryParameters&&r.push(e.queryParameters),e.extraQueryParameters&&r.push(e.extraQueryParameters),r.push("client-request-id="+encodeURIComponent(e.correlationId)),r},e.translateclientIdUsedInScope=function(e,t){var r=e.indexOf(t);r>=0&&(e.splice(r,1),-1===e.indexOf("openid")&&e.push("openid"),-1===e.indexOf("profile")&&e.push("profile"))},e.getCurrentUrl=function(){return window.location.href.split("?")[0].split("#")[0]},e.removeHashFromUrl=function(e){return e.split("#")[0]},e.replaceTenantPath=function(e,t){e=e.toLowerCase();var r=this.GetUrlComponents(e),n=r.PathSegments;return t&&0!==n.length&&n[0]===u.common&&(n[0]=t),this.constructAuthorityUriFromObject(r,n)},e.constructAuthorityUriFromObject=function(e,t){return this.CanonicalizeUri(e.Protocol+"//"+e.HostNameAndPort+"/"+t.join("/"))},e.GetUrlComponents=function(e){if(!e)throw"Url required";var t=RegExp("^(([^:/?#]+):)?(//([^/?#]*))?([^?#]*)(\\?([^#]*))?(#(.*))?"),r=e.match(t);if(!r||r.length<6)throw"Valid url required";var n={Protocol:r[1],HostNameAndPort:r[4],AbsolutePath:r[5]},o=n.AbsolutePath.split("/");return o=o.filter((function(e){return e&&e.length>0})),n.PathSegments=o,r[6]&&(n.Search=r[6]),r[8]&&(n.Hash=r[8]),n},e.CanonicalizeUri=function(t){return t&&(t=t.toLowerCase()),t&&!e.endsWith(t,"/")&&(t+="/"),t},e.endsWith=function(e,t){return!(!e||!t)&&-1!==e.indexOf(t,e.length-t.length)},e.urlRemoveQueryStringParameter=function(e,t){if(I.isEmpty(e))return e;var r=new RegExp("(\\&"+t+"=)[^&]+");return e=e.replace(r,""),r=new RegExp("("+t+"=)[^&]+&"),e=e.replace(r,""),r=new RegExp("("+t+"=)[^&]+"),e=e.replace(r,"")},e.getHashFromUrl=function(e){var t=e.indexOf("#"),r=e.indexOf("#/");return r>-1?e.substring(r+2):t>-1?e.substring(t+1):e},e.urlContainsHash=function(t){var r=e.deserializeHash(t);return r.hasOwnProperty(n.ERROR_DESCRIPTION)||r.hasOwnProperty(n.ERROR)||r.hasOwnProperty(n.ACCESS_TOKEN)||r.hasOwnProperty(n.ID_TOKEN)},e.deserializeHash=function(t){var r=e.getHashFromUrl(t);return c.deserialize(r)},e.getHostFromUri=function(e){var t=String(e).replace(/^(https?:)\/\//,"");return t=t.split("/")[0]},e}(),pe=function(e,t,r,n,o){this.authority=de.CanonicalizeUri(e),this.clientId=t,this.scopes=r,this.homeAccountIdentifier=c.base64Encode(n)+"."+c.base64Encode(o)},ge=function(e,t,r,n){this.accessToken=e,this.idToken=t,this.expiresIn=r,this.homeAccountIdentifier=n},fe=function(){function e(e,t,r,n,o,i,a){this.authorityInstance=e,this.clientId=t,this.nonce=c.createNewGuid(),this.scopes=o?o.slice():[t],this.scopes=he.trimAndConvertArrayToLowerCase(this.scopes),this.state=i,this.correlationId=a,this.xClientSku="MSAL.JS",this.xClientVer="1.3.3",this.responseType=r,this.redirectUri=n}return Object.defineProperty(e.prototype,"authority",{get:function(){return this.authorityInstance?this.authorityInstance.CanonicalAuthority:null},enumerable:!0,configurable:!0}),e.prototype.populateQueryParams=function(t,r,n,o){var i={};r&&(r.prompt&&(this.promptValue=r.prompt),r.claimsRequest&&(this.claimsValue=r.claimsRequest),e.isSSOParam(r)&&(i=this.constructUnifiedCacheQueryParameter(r,null))),n&&(i=this.constructUnifiedCacheQueryParameter(null,n)),i=this.addHintParameters(t,i);var a=r?r.extraQueryParameters:null;this.queryParameters=e.generateQueryParametersString(i),this.extraQueryParameters=e.generateQueryParametersString(a,o)},e.prototype.constructUnifiedCacheQueryParameter=function(e,t){var r,n;if(e)if(e.account){var o=e.account;o.sid?(r=l.SID,n=o.sid):o.userName&&(r=l.LOGIN_HINT,n=o.userName)}else e.sid?(r=l.SID,n=e.sid):e.loginHint&&(r=l.LOGIN_HINT,n=e.loginHint);else t&&t.hasOwnProperty(u.upn)&&(r=l.ID_TOKEN,n=t.upn);return this.addSSOParameter(r,n)},e.prototype.addHintParameters=function(e,t){e&&!t[l.SID]&&(!t[l.LOGIN_HINT]&&e.sid&&this.promptValue===p.NONE?t=this.addSSOParameter(l.SID,e.sid,t):!t[l.LOGIN_HINT]&&e.userName&&!I.isEmpty(e.userName)&&(t=this.addSSOParameter(l.LOGIN_HINT,e.userName,t)));return t},e.prototype.addSSOParameter=function(e,t,r){if(r||(r={}),!t)return r;switch(e){case l.SID:r[l.SID]=t;break;case l.ID_TOKEN:case l.LOGIN_HINT:r[l.LOGIN_HINT]=t}return r},e.generateQueryParametersString=function(e,t){var r=null;return e&&Object.keys(e).forEach((function(n){n===u.domain_hint&&(t||e[l.SID])||(null==r?r=n+"="+encodeURIComponent(e[n]):r+="&"+n+"="+encodeURIComponent(e[n]))})),r},e.isSSOParam=function(e){return e&&(e.account||e.sid||e.loginHint)},e}(),me=function(){function e(e){if(!e||I.isEmpty(e))return this.uid="",void(this.utid="");try{var t=c.base64Decode(e),r=JSON.parse(t);r&&(r.hasOwnProperty("uid")&&(this.uid=r.uid),r.hasOwnProperty("utid")&&(this.utid=r.utid))}catch(e){throw G.createClientInfoDecodingError(e)}}return Object.defineProperty(e.prototype,"uid",{get:function(){return this._uid?this._uid:""},set:function(e){this._uid=e},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"utid",{get:function(){return this._utid?this._utid:""},set:function(e){this._utid=e},enumerable:!0,configurable:!0}),e}(),ye=function(){function e(){}return e.decodeJwt=function(e){if(I.isEmpty(e))return null;var t=/^([^\.\s]*)\.([^\.\s]+)\.([^\.\s]*)$/.exec(e);return!t||t.length<4?null:{header:t[1],JWSPayload:t[2],JWSSig:t[3]}},e.extractIdToken=function(e){var t=this.decodeJwt(e);if(!t)return null;try{var r=t.JWSPayload,n=c.base64Decode(r);return n?JSON.parse(n):null}catch(e){}return null},e}(),ve=function(e){if(I.isEmpty(e))throw G.createIdTokenNullOrEmptyError(e);try{this.rawIdToken=e,this.claims=ye.extractIdToken(e),this.claims&&(this.claims.hasOwnProperty("iss")&&(this.issuer=this.claims.iss),this.claims.hasOwnProperty("oid")&&(this.objectId=this.claims.oid),this.claims.hasOwnProperty("sub")&&(this.subject=this.claims.sub),this.claims.hasOwnProperty("tid")&&(this.tenantId=this.claims.tid),this.claims.hasOwnProperty("ver")&&(this.version=this.claims.ver),this.claims.hasOwnProperty("preferred_username")&&(this.preferredName=this.claims.preferred_username),this.claims.hasOwnProperty("name")&&(this.name=this.claims.name),this.claims.hasOwnProperty("nonce")&&(this.nonce=this.claims.nonce),this.claims.hasOwnProperty("exp")&&(this.expiration=this.claims.exp),this.claims.hasOwnProperty("home_oid")&&(this.homeObjectId=this.claims.home_oid),this.claims.hasOwnProperty("sid")&&(this.sid=this.claims.sid),this.claims.hasOwnProperty("cloud_instance_host_name")&&(this.cloudInstance=this.claims.cloud_instance_host_name))}catch(e){throw G.createIdTokenParsingError(e)}},be=function(e,t){this.key=e,this.value=t},Ie=function(){function e(e){if(!window)throw b.createNoWindowObjectError("Browser storage class could not find window object");if(!(void 0!==window[e]&&null!=window[e]))throw le.createStorageNotSupportedError(e);this.cacheLocation=e}return e.prototype.setItem=function(e,t,r){window[this.cacheLocation].setItem(e,t),r&&this.setItemCookie(e,t)},e.prototype.getItem=function(e,t){return t&&this.getItemCookie(e)?this.getItemCookie(e):window[this.cacheLocation].getItem(e)},e.prototype.removeItem=function(e){return window[this.cacheLocation].removeItem(e)},e.prototype.clear=function(){return window[this.cacheLocation].clear()},e.prototype.setItemCookie=function(e,t,r){var n=e+"="+t+";path=/;";r&&(n+="expires="+this.getCookieExpirationTime(r)+";");document.cookie=n},e.prototype.getItemCookie=function(e){for(var t=e+"=",r=document.cookie.split(";"),n=0;n<r.length;n++){for(var o=r[n];" "===o.charAt(0);)o=o.substring(1);if(0===o.indexOf(t))return o.substring(t.length,o.length)}return""},e.prototype.clearItemCookie=function(e){this.setItemCookie(e,"",-1)},e.prototype.getCookieExpirationTime=function(e){var t=new Date;return new Date(t.getTime()+24*e*60*60*1e3).toUTCString()},e}(),we=function(){function e(){}return e.parseExpiresIn=function(e){return e||(e="3599"),parseInt(e,10)},e.now=function(){return Math.round((new Date).getTime()/1e3)},e.relativeNowMs=function(){return window.performance.now()},e}(),Te=function(){function e(){}return e.validateRequest=function(e,t,r,n){if(!t&&!e)throw le.createEmptyRequestError();var o,i;e&&(o=t?he.appendScopes(e.scopes,e.extraScopesToConsent):e.scopes,he.validateInputScope(o,!t,r),this.validatePromptParameter(e.prompt),i=this.validateEQParameters(e.extraQueryParameters,e.claimsRequest),this.validateClaimsRequest(e.claimsRequest));var a=this.validateAndGenerateState(e&&e.state,n),c=this.validateAndGenerateCorrelationId(e&&e.correlationId);return s.a({},e,{extraQueryParameters:i,scopes:o,state:a,correlationId:c})},e.validatePromptParameter=function(e){if(e&&[p.LOGIN,p.SELECT_ACCOUNT,p.CONSENT,p.NONE].indexOf(e)<0)throw le.createInvalidPromptError(e)},e.validateEQParameters=function(e,t){var r=s.a({},e);return r?(t&&delete r[u.claims],h.forEach((function(e){r[e]&&delete r[e]})),r):null},e.validateClaimsRequest=function(e){if(e)try{JSON.parse(e)}catch(e){throw le.createClaimsRequestParsingError(e)}},e.validateAndGenerateState=function(t,r){return I.isEmpty(t)?e.generateLibraryState(r):""+e.generateLibraryState(r)+u.resourceDelimiter+t},e.generateLibraryState=function(e){var t={id:c.createNewGuid(),ts:we.now(),method:e},r=JSON.stringify(t);return c.base64Encode(r)},e.parseLibraryState=function(e){var t=decodeURIComponent(e).split(u.resourceDelimiter)[0];if(c.isGuid(t))return{id:t,ts:we.now(),method:u.interactionTypeRedirect};try{var r=c.base64Decode(t);return JSON.parse(r)}catch(t){throw G.createInvalidStateError(e,null)}},e.validateAndGenerateCorrelationId=function(e){if(e&&!c.isGuid(e))throw le.createInvalidCorrelationIdError();return c.isGuid(e)?e:c.createNewGuid()},e.createRequestSignature=function(e){return""+e.scopes.join(" ").toLowerCase()+u.resourceDelimiter+e.authority},e}(),Ee=function(e){function t(t,r,n){var o=e.call(this,r)||this;return o.clientId=t,o.rollbackEnabled=!0,o.migrateCacheEntries(n),o}return s.d(t,e),t.prototype.migrateCacheEntries=function(t){var r=this,n=u.cachePrefix+"."+i.IDTOKEN,o=u.cachePrefix+"."+i.CLIENT_INFO,s=u.cachePrefix+"."+a.ERROR,c=u.cachePrefix+"."+a.ERROR_DESC,l=[e.prototype.getItem.call(this,n),e.prototype.getItem.call(this,o),e.prototype.getItem.call(this,s),e.prototype.getItem.call(this,c)];[i.IDTOKEN,i.CLIENT_INFO,a.ERROR,a.ERROR_DESC].forEach((function(e,n){return r.duplicateCacheEntry(e,l[n],t)}))},t.prototype.duplicateCacheEntry=function(e,t,r){t&&this.setItem(e,t,r)},t.prototype.generateCacheKey=function(e,t){try{return JSON.parse(e),e}catch(r){return 0===e.indexOf(""+u.cachePrefix)||0===e.indexOf(u.adalIdToken)?e:t?u.cachePrefix+"."+this.clientId+"."+e:u.cachePrefix+"."+e}},t.prototype.setItem=function(t,r,n){e.prototype.setItem.call(this,this.generateCacheKey(t,!0),r,n),this.rollbackEnabled&&!n&&e.prototype.setItem.call(this,this.generateCacheKey(t,!1),r,n)},t.prototype.getItem=function(t,r){return e.prototype.getItem.call(this,this.generateCacheKey(t,!0),r)},t.prototype.removeItem=function(t){e.prototype.removeItem.call(this,this.generateCacheKey(t,!0)),this.rollbackEnabled&&e.prototype.removeItem.call(this,this.generateCacheKey(t,!1))},t.prototype.resetCacheItems=function(){var t,r=window[this.cacheLocation];for(t in r)r.hasOwnProperty(t)&&-1!==t.indexOf(u.cachePrefix)&&e.prototype.removeItem.call(this,t)},t.prototype.resetTempCacheItems=function(t){var r=this,n=t&&Te.parseLibraryState(t).id,i=this.tokenRenewalInProgress(t),a=window[this.cacheLocation];n&&!i&&Object.keys(a).forEach((function(t){-1!==t.indexOf(n)&&(r.removeItem(t),e.prototype.clearItemCookie.call(r,t))})),this.removeItem(o.INTERACTION_STATUS),this.removeItem(o.REDIRECT_REQUEST)},t.prototype.setItemCookie=function(t,r,n){e.prototype.setItemCookie.call(this,this.generateCacheKey(t,!0),r,n),this.rollbackEnabled&&e.prototype.setItemCookie.call(this,this.generateCacheKey(t,!1),r,n)},t.prototype.clearItemCookie=function(t){e.prototype.clearItemCookie.call(this,this.generateCacheKey(t,!0)),this.rollbackEnabled&&e.prototype.clearItemCookie.call(this,this.generateCacheKey(t,!1))},t.prototype.getItemCookie=function(t){return e.prototype.getItemCookie.call(this,this.generateCacheKey(t,!0))},t.prototype.getAllAccessTokens=function(e,t){var r=this;return Object.keys(window[this.cacheLocation]).reduce((function(n,o){if(o.match(e)&&o.match(t)&&o.match(u.scopes)){var i=r.getItem(o);if(i)try{var a=JSON.parse(o),s=new be(a,JSON.parse(i));return n.concat([s])}catch(e){throw G.createCacheParseError(o)}}return n}),[])},t.prototype.tokenRenewalInProgress=function(e){var r=this.getItem(t.generateTemporaryCacheKey(o.RENEW_STATUS,e));return!(!r||r!==u.inProgress)},t.prototype.clearMsalCookie=function(r){var n=this;r?(this.clearItemCookie(t.generateTemporaryCacheKey(o.NONCE_IDTOKEN,r)),this.clearItemCookie(t.generateTemporaryCacheKey(o.STATE_LOGIN,r)),this.clearItemCookie(t.generateTemporaryCacheKey(o.LOGIN_REQUEST,r)),this.clearItemCookie(t.generateTemporaryCacheKey(o.STATE_ACQ_TOKEN,r))):document.cookie.split(";").forEach((function(t){var r=t.trim().split("=")[0];r.indexOf(u.cachePrefix)>-1&&e.prototype.clearItemCookie.call(n,r)}))},t.generateAcquireTokenAccountKey=function(e,t){var r=Te.parseLibraryState(t).id;return""+o.ACQUIRE_TOKEN_ACCOUNT+u.resourceDelimiter+e+u.resourceDelimiter+r},t.generateAuthorityKey=function(e){return t.generateTemporaryCacheKey(o.AUTHORITY,e)},t.generateTemporaryCacheKey=function(e,t){var r=Te.parseLibraryState(t).id;return""+e+u.resourceDelimiter+r},t}(Ie),Se=function(){function e(e,t,r,n,o,i,a){this.accountIdentifier=e,this.homeAccountIdentifier=t,this.userName=r,this.name=n,this.idToken=o,this.idTokenClaims=o,this.sid=i,this.environment=a}return e.createAccount=function(t,r){var n,o=t.objectId||t.subject,i=r?r.uid:"",a=r?r.utid:"";return I.isEmpty(i)||I.isEmpty(a)||(n=c.base64Encode(i)+"."+c.base64Encode(a)),new e(o,n,t.preferredName,t.name,t.claims,t.sid,t.issuer)},e.compareAccounts=function(e,t){return!(!e||!t)&&!(!e.homeAccountIdentifier||!t.homeAccountIdentifier||e.homeAccountIdentifier!==t.homeAccountIdentifier)},e}(),Ce=function(){function e(){}return e.isInIframe=function(){return window.parent!==window},e.isInPopup=function(){return!(!window.opener||window.opener===window)},e.generateFrameName=function(e,t){return""+e+u.resourceDelimiter+t},e.monitorIframeForHash=function(t,r,n,o){return new Promise((function(i,a){var s=we.relativeNowMs()+r;o.verbose("monitorWindowForIframe polling started");var c=setInterval((function(){if(we.relativeNowMs()>s)return o.error("monitorIframeForHash unable to find hash in url, timing out"),o.errorPii("monitorIframeForHash polling timed out for url: "+n),clearInterval(c),void a(G.createTokenRenewalTimeoutError());var e;try{e=t.location.href}catch(e){}e&&de.urlContainsHash(e)&&(o.verbose("monitorIframeForHash found url in hash"),clearInterval(c),i(t.location.hash))}),e.POLLING_INTERVAL_MS)}))},e.monitorPopupForHash=function(t,r,n,o){return new Promise((function(i,a){var s=r/e.POLLING_INTERVAL_MS,c=0;o.verbose("monitorWindowForHash polling started");var u=setInterval((function(){if(t.closed)return o.error("monitorWindowForHash window closed"),clearInterval(u),void a(G.createUserCancelledError());var e;try{e=t.location.href}catch(e){}e&&"about:blank"!==e&&(c++,e&&de.urlContainsHash(e)?(o.verbose("monitorPopupForHash found url in hash"),clearInterval(u),i(t.location.hash)):c>s&&(o.error("monitorPopupForHash unable to find hash in url, timing out"),o.errorPii("monitorPopupForHash polling timed out for url: "+n),clearInterval(u),a(G.createTokenRenewalTimeoutError())))}),e.POLLING_INTERVAL_MS)}))},e.loadFrame=function(e,t,r,n){var o=this;return n.infoPii("LoadFrame: "+t),new Promise((function(i,a){setTimeout((function(){var r=o.loadFrameSync(e,t,n);r?i(r):a("Unable to load iframe with name: "+t)}),r)}))},e.loadFrameSync=function(t,r,n){var o=e.addHiddenIFrame(r,n);return o?(""!==o.src&&"about:blank"!==o.src||(o.src=t,n.infoPii("Frame Name : "+r+" Navigated to: "+t)),o):null},e.addHiddenIFrame=function(e,t){if(void 0===e)return null;t.infoPii("Add msal frame to document:"+e);var r=document.getElementById(e);if(!r){if(document.createElement&&document.documentElement&&-1===window.navigator.userAgent.indexOf("MSIE 5.0")){var n=document.createElement("iframe");n.setAttribute("id",e),n.setAttribute("aria-hidden","true"),n.style.visibility="hidden",n.style.position="absolute",n.style.width=n.style.height="0",n.style.border="0",n.setAttribute("sandbox","allow-scripts allow-same-origin allow-forms"),r=document.getElementsByTagName("body")[0].appendChild(n)}else document.body&&document.body.insertAdjacentHTML&&document.body.insertAdjacentHTML("beforeend","<iframe name='"+e+"' id='"+e+"' style='display:none'></iframe>");window.frames&&window.frames[e]&&(r=window.frames[e])}return r},e.removeHiddenIframe=function(e){document.body===e.parentNode&&document.body.removeChild(e)},e.getIframeWithHash=function(e){var t=document.getElementsByTagName("iframe");return Array.apply(null,Array(t.length)).map((function(e,r){return t.item(r)})).filter((function(t){try{return t.contentWindow.location.hash===e}catch(e){return!1}}))[0]},e.getPopups=function(){return window.openedWindows||(window.openedWindows=[]),window.openedWindows},e.getPopUpWithHash=function(t){return e.getPopups().filter((function(e){try{return e.location.hash===t}catch(e){return!1}}))[0]},e.trackPopup=function(t){e.getPopups().push(t)},e.closePopups=function(){e.getPopups().forEach((function(e){return e.close()}))},e.blockReloadInHiddenIframes=function(){if(de.urlContainsHash(window.location.hash)&&e.isInIframe())throw G.createBlockTokenRequestsInHiddenIframeError()},e.checkIfBackButtonIsPressed=function(e){var t=e.getItem(o.REDIRECT_REQUEST);if(t&&!de.urlContainsHash(window.location.hash)){var r=t.split(u.resourceDelimiter),n=r.length>1?r[r.length-1]:null;e.resetTempCacheItems(n)}},e.POLLING_INTERVAL_MS=50,e}(),ke=function(){function e(){}return e.setResponseIdToken=function(e,t){if(!e)return null;if(!t)return e;var r=Number(t.expiration);return r&&!e.expiresOn&&(e.expiresOn=new Date(1e3*r)),s.a({},e,{idToken:t,idTokenClaims:t.claims,uniqueId:t.objectId||t.subject,tenantId:t.tenantId})},e}(),Ae=function(){function e(){}return e.prototype.sendRequestAsync=function(e,t,r){var n=this;return new Promise((function(r,o){var i=new XMLHttpRequest;if(i.open(t,e,!0),i.onload=function(e){var t;(i.status<200||i.status>=300)&&o(n.handleError(i.responseText));try{t=JSON.parse(i.responseText)}catch(e){o(n.handleError(i.responseText))}var a={statusCode:i.status,body:t};r(a)},i.onerror=function(e){o(i.status)},t!==d)throw"not implemented";i.send()}))},e.prototype.handleError=function(e){var t;try{if((t=JSON.parse(e)).error)return t.error;throw e}catch(t){return e}},e}(),Re=function(){function e(){}return e.setTrustedAuthoritiesFromConfig=function(t,r){t&&!this.getTrustedHostList().length&&r.forEach((function(t){e.TrustedHostList.push(t.toLowerCase())}))},e.getAliases=function(e,t,r){return s.b(this,void 0,void 0,(function(){var n,o,i,a;return s.e(this,(function(s){return n=new Ae,o=d,i="https://login.microsoftonline.com/common//discovery/instance?api-version=1.1&authorization_endpoint="+e+"oauth2/v2.0/authorize",a=t.createAndStartHttpEvent(r,o,i,"getAliases"),[2,n.sendRequestAsync(i,o,!0).then((function(e){return a.httpResponseStatus=e.statusCode,t.stopEvent(a),e.body.metadata})).catch((function(e){throw a.serverErrorCode=e,t.stopEvent(a),e}))]}))}))},e.setTrustedAuthoritiesFromNetwork=function(t,r,n){return s.b(this,void 0,void 0,(function(){var o;return s.e(this,(function(i){switch(i.label){case 0:return[4,this.getAliases(t,r,n)];case 1:return i.sent().forEach((function(t){t.aliases.forEach((function(t){e.TrustedHostList.push(t.toLowerCase())}))})),o=de.GetUrlComponents(t).HostNameAndPort,e.getTrustedHostList().length&&!e.IsInTrustedHostList(o)&&e.TrustedHostList.push(o.toLowerCase()),[2]}}))}))},e.getTrustedHostList=function(){return this.TrustedHostList},e.IsInTrustedHostList=function(e){return this.TrustedHostList.indexOf(e.toLowerCase())>-1},e.TrustedHostList=[],e}();!function(e){e[e.Default=0]="Default",e[e.Adfs=1]="Adfs"}(m||(m={}));var Oe,_e=function(){function e(e,t,r){this.IsValidationEnabled=t,this.CanonicalAuthority=e,this.validateAsUri(),this.tenantDiscoveryResponse=r}return Object.defineProperty(e.prototype,"Tenant",{get:function(){return this.CanonicalAuthorityUrlComponents.PathSegments[0]},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"AuthorizationEndpoint",{get:function(){return this.validateResolved(),this.tenantDiscoveryResponse.AuthorizationEndpoint.replace(/{tenant}|{tenantid}/g,this.Tenant)},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"EndSessionEndpoint",{get:function(){return this.validateResolved(),this.tenantDiscoveryResponse.EndSessionEndpoint.replace(/{tenant}|{tenantid}/g,this.Tenant)},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"SelfSignedJwtAudience",{get:function(){return this.validateResolved(),this.tenantDiscoveryResponse.Issuer.replace(/{tenant}|{tenantid}/g,this.Tenant)},enumerable:!0,configurable:!0}),e.prototype.validateResolved=function(){if(!this.hasCachedMetadata())throw"Please call ResolveEndpointsAsync first"},Object.defineProperty(e.prototype,"CanonicalAuthority",{get:function(){return this.canonicalAuthority},set:function(e){this.canonicalAuthority=de.CanonicalizeUri(e),this.canonicalAuthorityUrlComponents=null},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"CanonicalAuthorityUrlComponents",{get:function(){return this.canonicalAuthorityUrlComponents||(this.canonicalAuthorityUrlComponents=de.GetUrlComponents(this.CanonicalAuthority)),this.canonicalAuthorityUrlComponents},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"DefaultOpenIdConfigurationEndpoint",{get:function(){return this.CanonicalAuthority+"v2.0/.well-known/openid-configuration"},enumerable:!0,configurable:!0}),e.prototype.validateAsUri=function(){var e;try{e=this.CanonicalAuthorityUrlComponents}catch(e){throw Z}if(!e.Protocol||"https:"!==e.Protocol.toLowerCase())throw ee;if(!e.PathSegments||e.PathSegments.length<1)throw te},e.prototype.DiscoverEndpoints=function(e,t,r){var n=new Ae,o=d,i=t.createAndStartHttpEvent(r,o,e,"openIdConfigurationEndpoint");return n.sendRequestAsync(e,o,!0).then((function(e){return i.httpResponseStatus=e.statusCode,t.stopEvent(i),{AuthorizationEndpoint:e.body.authorization_endpoint,EndSessionEndpoint:e.body.end_session_endpoint,Issuer:e.body.issuer}})).catch((function(e){throw i.serverErrorCode=e,t.stopEvent(i),e}))},e.prototype.resolveEndpointsAsync=function(e,t){return s.b(this,void 0,void 0,(function(){var r,n,o;return s.e(this,(function(i){switch(i.label){case 0:return this.IsValidationEnabled?(r=this.canonicalAuthorityUrlComponents.HostNameAndPort,0!==Re.getTrustedHostList().length?[3,2]:[4,Re.setTrustedAuthoritiesFromNetwork(this.canonicalAuthority,e,t)]):[3,3];case 1:i.sent(),i.label=2;case 2:if(!Re.IsInTrustedHostList(r))throw le.createUntrustedAuthorityError(r);i.label=3;case 3:return n=this.GetOpenIdConfigurationEndpoint(),o=this,[4,this.DiscoverEndpoints(n,e,t)];case 4:return o.tenantDiscoveryResponse=i.sent(),[2,this.tenantDiscoveryResponse]}}))}))},e.prototype.hasCachedMetadata=function(){return!!(this.tenantDiscoveryResponse&&this.tenantDiscoveryResponse.AuthorizationEndpoint&&this.tenantDiscoveryResponse.EndSessionEndpoint&&this.tenantDiscoveryResponse.Issuer)},e.prototype.GetOpenIdConfigurationEndpoint=function(){return this.DefaultOpenIdConfigurationEndpoint},e}(),Pe=function(){function e(){}return e.saveMetadataFromNetwork=function(e,t,r){return s.b(this,void 0,void 0,(function(){var n;return s.e(this,(function(o){switch(o.label){case 0:return[4,e.resolveEndpointsAsync(t,r)];case 1:return n=o.sent(),this.metadataMap.set(e.CanonicalAuthority,n),[2,n]}}))}))},e.getMetadata=function(e){return this.metadataMap.get(e)},e.saveMetadataFromConfig=function(e,t){try{if(t){var r=JSON.parse(t);if(!r.authorization_endpoint||!r.end_session_endpoint||!r.issuer)throw le.createInvalidAuthorityMetadataError();this.metadataMap.set(e,{AuthorizationEndpoint:r.authorization_endpoint,EndSessionEndpoint:r.end_session_endpoint,Issuer:r.issuer})}}catch(e){throw le.createInvalidAuthorityMetadataError()}},e.CreateInstance=function(e,t,r){return I.isEmpty(e)?null:(r&&this.saveMetadataFromConfig(e,r),new _e(e,t,this.metadataMap.get(e)))},e.isAdfs=function(e){var t=de.GetUrlComponents(e).PathSegments;return!(!t.length||t[0].toLowerCase()!==u.ADFS)},e.metadataMap=new Map,e}();!function(e){e[e.Error=0]="Error",e[e.Warning=1]="Warning",e[e.Info=2]="Info",e[e.Verbose=3]="Verbose"}(Oe||(Oe={}));var Ne=function(){function e(e,t){void 0===t&&(t={}),this.level=Oe.Info;var r=t.correlationId,n=void 0===r?"":r,o=t.level,i=void 0===o?Oe.Info:o,a=t.piiLoggingEnabled,s=void 0!==a&&a;this.localCallback=e,this.correlationId=n,this.level=i,this.piiLoggingEnabled=s}return e.prototype.logMessage=function(e,t,r){if(!(e>this.level||!this.piiLoggingEnabled&&r)){var n,o=(new Date).toUTCString();n=I.isEmpty(this.correlationId)?o+":1.3.3-"+Oe[e]+(r?"-pii":"")+" "+t:o+":"+this.correlationId+"-1.3.3-"+Oe[e]+(r?"-pii":"")+" "+t,this.executeCallback(e,n,r)}},e.prototype.executeCallback=function(e,t,r){this.localCallback&&this.localCallback(e,t,r)},e.prototype.error=function(e){this.logMessage(Oe.Error,e,!1)},e.prototype.errorPii=function(e){this.logMessage(Oe.Error,e,!0)},e.prototype.warning=function(e){this.logMessage(Oe.Warning,e,!1)},e.prototype.warningPii=function(e){this.logMessage(Oe.Warning,e,!0)},e.prototype.info=function(e){this.logMessage(Oe.Info,e,!1)},e.prototype.infoPii=function(e){this.logMessage(Oe.Info,e,!0)},e.prototype.verbose=function(e){this.logMessage(Oe.Verbose,e,!1)},e.prototype.verbosePii=function(e){this.logMessage(Oe.Verbose,e,!0)},e.prototype.isPiiLoggingEnabled=function(){return this.piiLoggingEnabled},e}(),Le={clientId:"",authority:null,validateAuthority:!0,authorityMetadata:"",knownAuthorities:[],redirectUri:function(){return de.getCurrentUrl()},postLogoutRedirectUri:function(){return de.getCurrentUrl()},navigateToLoginRequestUrl:!0},Ue={cacheLocation:"sessionStorage",storeAuthStateInCookie:!1},qe={logger:new Ne(null),loadFrameTimeout:6e3,tokenRenewalOffsetSeconds:300,navigateFrameWait:500},xe={isAngular:!1,unprotectedResources:new Array,protectedResourceMap:new Map};var Me={code:"server_unavailable",desc:"Server is temporarily unavailable."},He={code:"unknown_server_error"},je=function(e){function t(r,n){var o=e.call(this,r,n)||this;return o.name="ServerError",Object.setPrototypeOf(o,t.prototype),o}return s.d(t,e),t.createServerUnavailableError=function(){return new t(Me.code,Me.desc)},t.createUnknownServerError=function(e){return new t(He.code,e)},t}(b),De={code:"interaction_required"},Fe={code:"consent_required"},Ke={code:"login_required"},Ge=function(e){function t(r,n){var o=e.call(this,r,n)||this;return o.name="InteractionRequiredAuthError",Object.setPrototypeOf(o,t.prototype),o}return s.d(t,e),t.isInteractionRequiredError=function(e){var t=[De.code,Fe.code,Ke.code];return e&&t.indexOf(e)>-1},t.createLoginRequiredAuthError=function(e){return new t(Ke.code,e)},t.createInteractionRequiredAuthError=function(e){return new t(De.code,e)},t.createConsentRequiredAuthError=function(e){return new t(Fe.code,e)},t}(je);function We(e){return{uniqueId:"",tenantId:"",tokenType:"",idToken:null,idTokenClaims:null,accessToken:"",scopes:null,expiresOn:null,account:null,accountState:e,fromCache:!1}}var Qe,Ve,Je,ze="Microsoft.MSAL.correlation_id",Be="msal.api_telem_id",Xe="msal.api_id",Ye="Microsoft_MSAL_cache_event_count",$e="Microsoft_MSAL_http_event_count",Ze="Microsoft_MSAL_ui_event_count",et=function(e){var t=de.GetUrlComponents(e);if(Pe.isAdfs(e))return e;var r=t.PathSegments;if(r&&r.length>=2){var n="tfp"===r[1]?2:1;n<r.length&&(r[n]="<tenant>")}return t.Protocol+"//"+t.HostNameAndPort+"/"+r.join("/")},tt=function(e){return c.base64Encode(e)},rt=function(e){return"msal."+(e||"")},nt=function(){return!!("undefined"!=typeof window&&"performance"in window&&window.performance.mark&&window.performance.measure)},ot=function(){function e(e,t,r){var n;this.eventId=c.createNewGuid(),this.label=r,this.event=((n={})[rt("event_name")]=e,n[rt("elapsed_time")]=-1,n[""+ze]=t,n)}return e.prototype.setElapsedTime=function(e){this.event[rt("elapsed_time")]=e},e.prototype.stop=function(){var e,t,r;this.setElapsedTime(+Date.now()-+this.startTimestamp),e=this.displayName,t=this.perfStartMark,r=this.perfEndMark,nt()&&(window.performance.mark(r),window.performance.measure(e,t,r),window.performance.clearMeasures(e),window.performance.clearMarks(t),window.performance.clearMarks(r))},e.prototype.start=function(){var e;this.startTimestamp=Date.now(),this.event[rt("start_time")]=this.startTimestamp,e=this.perfStartMark,nt()&&window.performance.mark(e)},Object.defineProperty(e.prototype,"telemetryCorrelationId",{get:function(){return this.event[""+ze]},set:function(e){this.event[""+ze]=e},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"eventName",{get:function(){return this.event[rt("event_name")]},enumerable:!0,configurable:!0}),e.prototype.get=function(){return s.a({},this.event,{eventId:this.eventId})},Object.defineProperty(e.prototype,"key",{get:function(){return this.telemetryCorrelationId+"_"+this.eventId+"-"+this.eventName},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"displayName",{get:function(){return"Msal-"+this.label+"-"+this.telemetryCorrelationId},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"perfStartMark",{get:function(){return"start-"+this.key},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"perfEndMark",{get:function(){return"end-"+this.key},enumerable:!0,configurable:!0}),e}(),it=function(e){function t(t,r,n,o){var i=e.call(this,rt("default_event"),r,"DefaultEvent")||this;return i.event[rt("client_id")]=n,i.event[rt("sdk_plaform")]=t.sdk,i.event[rt("sdk_version")]=t.sdkVersion,i.event[rt("application_name")]=t.applicationName,i.event[rt("application_version")]=t.applicationVersion,i.event[rt("effective_connection_speed")]=t.networkInformation&&t.networkInformation.connectionSpeed,i.event[""+Ze]=i.getEventCount(rt("ui_event"),o),i.event[""+$e]=i.getEventCount(rt("http_event"),o),i.event[""+Ye]=i.getEventCount(rt("cache_event"),o),i}return s.d(t,e),t.prototype.getEventCount=function(e,t){return t[e]?t[e]:0},t}(ot),at=rt("authority"),st=rt("authority_type"),ct=rt("ui_behavior"),ut=rt("tenant_id"),lt=rt("user_id"),ht=rt("was_successful"),dt=rt("api_error_code"),pt=rt("login_hint");!function(e){e[e.AcquireTokenRedirect=2001]="AcquireTokenRedirect",e[e.AcquireTokenSilent=2002]="AcquireTokenSilent",e[e.AcquireTokenPopup=2003]="AcquireTokenPopup",e[e.LoginRedirect=2004]="LoginRedirect",e[e.LoginPopup=2005]="LoginPopup",e[e.Logout=2006]="Logout"}(Ve||(Ve={})),function(e){e.AcquireTokenRedirect="AcquireTokenRedirect",e.AcquireTokenSilent="AcquireTokenSilent",e.AcquireTokenPopup="AcquireTokenPopup",e.LoginRedirect="LoginRedirect",e.LoginPopup="LoginPopup",e.Logout="Logout"}(Je||(Je={}));var gt=((Qe={})[Je.AcquireTokenSilent]=Ve.AcquireTokenSilent,Qe[Je.AcquireTokenPopup]=Ve.AcquireTokenPopup,Qe[Je.AcquireTokenRedirect]=Ve.AcquireTokenRedirect,Qe[Je.LoginPopup]=Ve.LoginPopup,Qe[Je.LoginRedirect]=Ve.LoginRedirect,Qe[Je.Logout]=Ve.Logout,Qe),ft=function(e){function t(t,r,n){var o=e.call(this,rt("api_event"),t,n)||this;return n&&(o.apiCode=gt[n],o.apiEventIdentifier=n),o.piiEnabled=r,o}return s.d(t,e),Object.defineProperty(t.prototype,"apiEventIdentifier",{set:function(e){this.event[Be]=e},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"apiCode",{set:function(e){this.event[Xe]=e},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"authority",{set:function(e){this.event[at]=et(e).toLowerCase()},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"apiErrorCode",{set:function(e){this.event[dt]=e},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"tenantId",{set:function(e){this.event[ut]=this.piiEnabled&&e?tt(e):null},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"accountId",{set:function(e){this.event[lt]=this.piiEnabled&&e?tt(e):null},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"wasSuccessful",{get:function(){return!0===this.event[ht]},set:function(e){this.event[ht]=e},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"loginHint",{set:function(e){this.event[pt]=this.piiEnabled&&e?tt(e):null},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"authorityType",{set:function(e){this.event[st]=e.toLowerCase()},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"promptType",{set:function(e){this.event[ct]=e.toLowerCase()},enumerable:!0,configurable:!0}),t}(ot),mt=rt("http_path"),yt=rt("user_agent"),vt=rt("query_parameters"),bt=rt("api_version"),It=rt("response_code"),wt=rt("oauth_error_code"),Tt=rt("http_method"),Et=rt("request_id_header"),St=rt("spe_info"),Ct=rt("server_error_code"),kt=rt("server_sub_error_code"),At=rt("url"),Rt=function(e){function t(t,r){return e.call(this,rt("http_event"),t,r)||this}return s.d(t,e),Object.defineProperty(t.prototype,"url",{set:function(e){var t=et(e);this.event[At]=t&&t.toLowerCase()},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"httpPath",{set:function(e){this.event[mt]=et(e).toLowerCase()},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"userAgent",{set:function(e){this.event[yt]=e},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"queryParams",{set:function(e){this.event[vt]=fe.generateQueryParametersString(e)},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"apiVersion",{set:function(e){this.event[bt]=e.toLowerCase()},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"httpResponseStatus",{set:function(e){this.event[It]=e},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"oAuthErrorCode",{set:function(e){this.event[wt]=e},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"httpMethod",{set:function(e){this.event[Tt]=e},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"requestIdHeader",{set:function(e){this.event[Et]=e},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"speInfo",{set:function(e){this.event[St]=e},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"serverErrorCode",{set:function(e){this.event[Ct]=e},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"serverSubErrorCode",{set:function(e){this.event[kt]=e},enumerable:!0,configurable:!0}),t}(ot),Ot=function(){function e(e,t,r){this.completedEvents={},this.inProgressEvents={},this.eventCountByCorrelationId={},this.onlySendFailureTelemetry=!1,this.telemetryPlatform=s.a({sdk:u.libraryName,sdkVersion:"1.3.3",networkInformation:{connectionSpeed:"undefined"!=typeof navigator&&navigator.connection&&navigator.connection.effectiveType}},e.platform),this.clientId=e.clientId,this.onlySendFailureTelemetry=e.onlySendFailureTelemetry,this.telemetryEmitter=t,this.logger=r}return e.getTelemetrymanagerStub=function(e,t){return new this({platform:{applicationName:"UnSetStub",applicationVersion:"0.0"},clientId:e},(function(){}),t)},e.prototype.startEvent=function(e){this.logger.verbose("Telemetry Event started: "+e.key),this.telemetryEmitter&&(e.start(),this.inProgressEvents[e.key]=e)},e.prototype.stopEvent=function(e){if(this.logger.verbose("Telemetry Event stopped: "+e.key),this.telemetryEmitter&&this.inProgressEvents[e.key]){e.stop(),this.incrementEventCount(e);var t=this.completedEvents[e.telemetryCorrelationId];this.completedEvents[e.telemetryCorrelationId]=(t||[]).concat([e]),delete this.inProgressEvents[e.key]}},e.prototype.flush=function(e){var t=this;if(this.logger.verbose("Flushing telemetry events: "+e),this.telemetryEmitter&&this.completedEvents[e]){var r=this.getOrphanedEvents(e);r.forEach((function(e){return t.incrementEventCount(e)}));var n=this.completedEvents[e].concat(r);delete this.completedEvents[e];var o=this.eventCountByCorrelationId[e];if(delete this.eventCountByCorrelationId[e],n&&n.length){var i=new it(this.telemetryPlatform,e,this.clientId,o),a=n.concat([i]);this.telemetryEmitter(a.map((function(e){return e.get()})))}}},e.prototype.createAndStartApiEvent=function(e,t){var r=new ft(e,this.logger.isPiiLoggingEnabled(),t);return this.startEvent(r),r},e.prototype.stopAndFlushApiEvent=function(e,t,r,n){t.wasSuccessful=r,n&&(t.apiErrorCode=n),this.stopEvent(t),this.flush(e)},e.prototype.createAndStartHttpEvent=function(e,t,r,n){var o=new Rt(e,n);return o.url=r,o.httpMethod=t,this.startEvent(o),o},e.prototype.incrementEventCount=function(e){var t,r=e.eventName,n=this.eventCountByCorrelationId[e.telemetryCorrelationId];n?n[r]=n[r]?n[r]+1:1:this.eventCountByCorrelationId[e.telemetryCorrelationId]=((t={})[r]=1,t)},e.prototype.getOrphanedEvents=function(e){var t=this;return Object.keys(this.inProgressEvents).reduce((function(r,n){if(-1!==n.indexOf(e)){var o=t.inProgressEvents[n];return delete t.inProgressEvents[n],r.concat([o])}return r}),[])},e}(),_t="id_token",Pt="token",Nt="id_token token",Lt=function(){function e(e){var t,r,n,o,i,a,c,l;this.authResponseCallback=null,this.tokenReceivedCallback=null,this.errorReceivedCallback=null,this.config=(r=(t=e).auth,n=t.cache,o=void 0===n?{}:n,i=t.system,a=void 0===i?{}:i,c=t.framework,l=void 0===c?{}:c,{auth:s.a({},Le,r),cache:s.a({},Ue,o),system:s.a({},qe,a),framework:s.a({},xe,l)}),this.logger=this.config.system.logger,this.clientId=this.config.auth.clientId,this.inCookie=this.config.cache.storeAuthStateInCookie,this.telemetryManager=this.getTelemetryManagerFromConfig(this.config.system.telemetry,this.clientId),Re.setTrustedAuthoritiesFromConfig(this.config.auth.validateAuthority,this.config.auth.knownAuthorities),Pe.saveMetadataFromConfig(this.config.auth.authority,this.config.auth.authorityMetadata),this.authority=this.config.auth.authority||"https://login.microsoftonline.com/common",this.cacheStorage=new Ee(this.clientId,this.config.cache.cacheLocation,this.inCookie),window.activeRenewals={},window.renewStates=[],window.callbackMappedToRenewStates={},window.promiseMappedToRenewStates={},window.msal=this;var h=window.location.hash,d=de.urlContainsHash(h);(Ce.checkIfBackButtonIsPressed(this.cacheStorage),d)&&(this.getResponseState(h).method===u.interactionTypeRedirect&&this.handleRedirectAuthenticationResponse(h))}return Object.defineProperty(e.prototype,"authority",{get:function(){return this.authorityInstance.CanonicalAuthority},set:function(e){this.authorityInstance=Pe.CreateInstance(e,this.config.auth.validateAuthority)},enumerable:!0,configurable:!0}),e.prototype.getAuthorityInstance=function(){return this.authorityInstance},e.prototype.handleRedirectCallback=function(e,t){if(!e)throw le.createInvalidCallbackObjectError(e);t?(this.tokenReceivedCallback=e,this.errorReceivedCallback=t,this.logger.warning("This overload for callback is deprecated - please change the format of the callbacks to a single callback as shown: (err: AuthError, response: AuthResponse).")):this.authResponseCallback=e,this.redirectError?this.authErrorHandler(u.interactionTypeRedirect,this.redirectError,this.redirectResponse):this.redirectResponse&&this.authResponseHandler(u.interactionTypeRedirect,this.redirectResponse)},e.prototype.urlContainsHash=function(e){return this.logger.verbose("UrlContainsHash has been called"),de.urlContainsHash(e)},e.prototype.authResponseHandler=function(e,t,r){if(this.logger.verbose("AuthResponseHandler has been called"),e===u.interactionTypeRedirect)this.logger.verbose("Interaction type is redirect"),this.errorReceivedCallback?(this.logger.verbose("Two callbacks were provided to handleRedirectCallback, calling success callback with response"),this.tokenReceivedCallback(t)):this.authResponseCallback&&(this.logger.verbose("One callback was provided to handleRedirectCallback, calling authResponseCallback with response"),this.authResponseCallback(null,t));else{if(e!==u.interactionTypePopup)throw G.createInvalidInteractionTypeError();this.logger.verbose("Interaction type is popup, resolving"),r(t)}},e.prototype.authErrorHandler=function(e,t,r,n){if(this.logger.verbose("AuthErrorHandler has been called"),this.cacheStorage.removeItem(o.INTERACTION_STATUS),e===u.interactionTypeRedirect)this.logger.verbose("Interaction type is redirect"),this.errorReceivedCallback?(this.logger.verbose("Two callbacks were provided to handleRedirectCallback, calling error callback"),this.errorReceivedCallback(t,r.accountState)):(this.logger.verbose("One callback was provided to handleRedirectCallback, calling authResponseCallback with error"),this.authResponseCallback(t,r));else{if(e!==u.interactionTypePopup)throw G.createInvalidInteractionTypeError();this.logger.verbose("Interaction type is popup, rejecting"),n(t)}},e.prototype.loginRedirect=function(e){this.logger.verbose("LoginRedirect has been called");var t=Te.validateRequest(e,!0,this.clientId,u.interactionTypeRedirect);this.acquireTokenInteractive(u.interactionTypeRedirect,!0,t,null,null)},e.prototype.acquireTokenRedirect=function(e){this.logger.verbose("AcquireTokenRedirect has been called");var t=Te.validateRequest(e,!1,this.clientId,u.interactionTypeRedirect);this.acquireTokenInteractive(u.interactionTypeRedirect,!1,t,null,null)},e.prototype.loginPopup=function(e){var t=this;this.logger.verbose("LoginPopup has been called");var r=Te.validateRequest(e,!0,this.clientId,u.interactionTypePopup),n=this.telemetryManager.createAndStartApiEvent(r.correlationId,Je.LoginPopup);return new Promise((function(e,n){t.acquireTokenInteractive(u.interactionTypePopup,!0,r,e,n)})).then((function(e){return t.logger.verbose("Successfully logged in"),t.telemetryManager.stopAndFlushApiEvent(r.correlationId,n,!0),e})).catch((function(e){throw t.cacheStorage.resetTempCacheItems(r.state),t.telemetryManager.stopAndFlushApiEvent(r.correlationId,n,!1,e.errorCode),e}))},e.prototype.acquireTokenPopup=function(e){var t=this;this.logger.verbose("AcquireTokenPopup has been called");var r=Te.validateRequest(e,!1,this.clientId,u.interactionTypePopup),n=this.telemetryManager.createAndStartApiEvent(r.correlationId,Je.AcquireTokenPopup);return new Promise((function(e,n){t.acquireTokenInteractive(u.interactionTypePopup,!1,r,e,n)})).then((function(e){return t.logger.verbose("Successfully acquired token"),t.telemetryManager.stopAndFlushApiEvent(r.correlationId,n,!0),e})).catch((function(e){throw t.cacheStorage.resetTempCacheItems(r.state),t.telemetryManager.stopAndFlushApiEvent(r.correlationId,n,!1,e.errorCode),e}))},e.prototype.acquireTokenInteractive=function(e,t,r,n,i){var a=this;this.logger.verbose("AcquireTokenInteractive has been called"),Ce.blockReloadInHiddenIframes();var s,c=this.cacheStorage.getItem(o.INTERACTION_STATUS);if(e===u.interactionTypeRedirect&&this.cacheStorage.setItem(o.REDIRECT_REQUEST,""+u.inProgress+u.resourceDelimiter+r.state),c===u.inProgress){var l=t?G.createLoginInProgressError():G.createAcquireTokenInProgressError(),h=We(this.getAccountState(r.state));return this.cacheStorage.resetTempCacheItems(r.state),void this.authErrorHandler(e,l,h,i)}if(r&&r.account&&!t?(s=r.account,this.logger.verbose("Account set from request")):(s=this.getAccount(),this.logger.verbose("Account set from MSAL Cache")),s||fe.isSSOParam(r))this.logger.verbose("User session exists, login not required"),this.acquireTokenHelper(s,e,t,r,n,i);else{if(!t){this.logger.verbose("AcquireToken call, no context or account given"),this.logger.info("User login is required");h=We(this.getAccountState(r.state));return this.cacheStorage.resetTempCacheItems(r.state),void this.authErrorHandler(e,G.createUserLoginRequiredError(),h,i)}if(this.extractADALIdToken()&&!r.scopes){this.logger.info("ADAL's idToken exists. Extracting login information from ADAL's idToken");var d=this.buildIDTokenRequest(r);this.silentLogin=!0,this.acquireTokenSilent(d).then((function(t){a.silentLogin=!1,a.logger.info("Unified cache call is successful"),a.authResponseHandler(e,t,n)}),(function(o){a.silentLogin=!1,a.logger.error("Error occurred during unified cache ATS: "+o),a.acquireTokenHelper(null,e,t,r,n,i)}))}else this.logger.verbose("Login call but no token found, proceed to login"),this.acquireTokenHelper(null,e,t,r,n,i)}},e.prototype.acquireTokenHelper=function(e,t,r,n,i,c){return s.b(this,void 0,void 0,(function(){var l,h,d,p,g,f,m,y,v,b;return s.e(this,(function(s){switch(s.label){case 0:this.logger.verbose("AcquireTokenHelper has been called"),this.logger.verbose("Interaction type: "+t+". isLoginCall: "+r),this.cacheStorage.setItem(o.INTERACTION_STATUS,u.inProgress),l=n.scopes?n.scopes.join(" ").toLowerCase():this.clientId.toLowerCase(),this.logger.verbosePii("Serialized scopes: "+l),d=n&&n.authority?Pe.CreateInstance(n.authority,this.config.auth.validateAuthority,n.authorityMetadata):this.authorityInstance,s.label=1;case 1:return s.trys.push([1,11,,12]),d.hasCachedMetadata()?[3,3]:(this.logger.verbose("No cached metadata for authority"),[4,Pe.saveMetadataFromNetwork(d,this.telemetryManager,n.correlationId)]);case 2:return s.sent(),[3,4];case 3:this.logger.verbose("Cached metadata found for authority"),s.label=4;case 4:if(g=r?_t:this.getTokenType(e,n.scopes,!1),f=n.redirectStartPage||window.location.href,h=new fe(d,this.clientId,g,this.getRedirectUri(n&&n.redirectUri),n.scopes,n.state,n.correlationId),this.logger.verbose("Finished building server authentication request"),this.updateCacheEntries(h,e,r,f),this.logger.verbose("Updating cache entries"),h.populateQueryParams(e,n),this.logger.verbose("Query parameters populated from account"),m=de.createNavigateUrl(h)+u.response_mode_fragment,t===u.interactionTypeRedirect)r?this.logger.verbose("Interaction type redirect but login call is true. State not cached"):(this.cacheStorage.setItem(Ee.generateTemporaryCacheKey(o.STATE_ACQ_TOKEN,n.state),h.state,this.inCookie),this.logger.verbose("State cached for redirect"),this.logger.verbosePii("State cached: "+h.state));else{if(t!==u.interactionTypePopup)throw this.logger.verbose("Invalid interaction error. State not cached"),G.createInvalidInteractionTypeError();window.renewStates.push(h.state),window.requestType=r?u.login:u.renewToken,this.logger.verbose("State saved to window"),this.logger.verbosePii("State saved: "+h.state),this.registerCallback(h.state,l,i,c)}if(t!==u.interactionTypePopup)return[3,9];this.logger.verbose("Interaction type is popup. Generating popup window");try{p=this.openPopup(m,"msal",u.popUpWidth,u.popUpHeight),Ce.trackPopup(p)}catch(e){if(this.logger.info(S.code+":"+S.desc),this.cacheStorage.setItem(a.ERROR,S.code),this.cacheStorage.setItem(a.ERROR_DESC,S.desc),c)return c(G.createPopupWindowError()),[2]}if(!p)return[3,8];s.label=5;case 5:return s.trys.push([5,7,,8]),[4,Ce.monitorPopupForHash(p,this.config.system.loadFrameTimeout,m,this.logger)];case 6:return y=s.sent(),this.handleAuthenticationResponse(y),this.cacheStorage.removeItem(o.INTERACTION_STATUS),this.logger.info("Closing popup window"),this.config.framework.isAngular&&(this.broadcast("msal:popUpHashChanged",y),Ce.closePopups()),[3,8];case 7:return v=s.sent(),c&&c(v),this.config.framework.isAngular?this.broadcast("msal:popUpClosed",v.errorCode+u.resourceDelimiter+v.errorMessage):(this.cacheStorage.removeItem(o.INTERACTION_STATUS),p.close()),[3,8];case 8:return[3,10];case 9:n.onRedirectNavigate?(this.logger.verbose("Invoking onRedirectNavigate callback"),!1!==n.onRedirectNavigate(m)?(this.logger.verbose("onRedirectNavigate did not return false, navigating"),this.navigateWindow(m)):this.logger.verbose("onRedirectNavigate returned false, stopping navigation")):(this.logger.verbose("Navigating window to urlNavigate"),this.navigateWindow(m)),s.label=10;case 10:return[3,12];case 11:return b=s.sent(),this.logger.error(b),this.cacheStorage.resetTempCacheItems(n.state),this.authErrorHandler(t,G.createEndpointResolutionError(b.toString),We(n.state),c),p&&p.close(),[3,12];case 12:return[2]}}))}))},e.prototype.ssoSilent=function(e){if(this.logger.verbose("ssoSilent has been called"),!e)throw le.createEmptyRequestError();if(!e.sid&&!e.loginHint)throw le.createSsoSilentError();return this.acquireTokenSilent(s.a({},e,{scopes:[this.clientId]}))},e.prototype.acquireTokenSilent=function(e){var t=this;this.logger.verbose("AcquireTokenSilent has been called");var r=Te.validateRequest(e,!1,this.clientId,u.interactionTypeSilent),n=this.telemetryManager.createAndStartApiEvent(r.correlationId,Je.AcquireTokenSilent),o=Te.createRequestSignature(r);return new Promise((function(e,n){return s.b(t,void 0,void 0,(function(){var t,i,a,c,l,h,d,p,g,f,m;return s.e(this,(function(s){switch(s.label){case 0:if(Ce.blockReloadInHiddenIframes(),t=r.scopes.join(" ").toLowerCase(),this.logger.verbosePii("Serialized scopes: "+t),r.account?(i=r.account,this.logger.verbose("Account set from request")):(i=this.getAccount(),this.logger.verbose("Account set from MSAL Cache")),a=this.cacheStorage.getItem(u.adalIdToken),!i&&!r.sid&&!r.loginHint&&I.isEmpty(a))return this.logger.info("User login is required"),[2,n(G.createUserLoginRequiredError())];if(c=this.getTokenType(i,r.scopes,!0),this.logger.verbose("Response type: "+c),l=new fe(Pe.CreateInstance(r.authority,this.config.auth.validateAuthority,r.authorityMetadata),this.clientId,c,this.getRedirectUri(r.redirectUri),r.scopes,r.state,r.correlationId),this.logger.verbose("Finished building server authentication request"),fe.isSSOParam(r)||i?(l.populateQueryParams(i,r,null,!0),this.logger.verbose("Query parameters populated from existing SSO or account")):i||I.isEmpty(a)?this.logger.verbose("No additional query parameters added"):(h=ye.extractIdToken(a),this.logger.verbose("ADAL's idToken exists. Extracting login information from ADAL's idToken to populate query parameters"),l.populateQueryParams(i,null,h,!0)),!(d=r.claimsRequest||l.claimsValue)&&!r.forceRefresh)try{g=this.getCachedToken(l,i)}catch(e){p=e}return g?(this.logger.verbose("Token found in cache lookup"),this.logger.verbosePii("Scopes found: "+JSON.stringify(g.scopes)),e(g),[2,null]):[3,1];case 1:return p?(this.logger.infoPii(p.errorCode+":"+p.errorMessage),n(p),[2,null]):[3,2];case 2:f=void 0,f=d?"Skipped cache lookup since claims were given":r.forceRefresh?"Skipped cache lookup since request.forceRefresh option was set to true":"No token found in cache lookup",this.logger.verbose(f),l.authorityInstance||(l.authorityInstance=r.authority?Pe.CreateInstance(r.authority,this.config.auth.validateAuthority,r.authorityMetadata):this.authorityInstance),this.logger.verbosePii("Authority instance: "+l.authority),s.label=3;case 3:return s.trys.push([3,7,,8]),l.authorityInstance.hasCachedMetadata()?[3,5]:(this.logger.verbose("No cached metadata for authority"),[4,Pe.saveMetadataFromNetwork(l.authorityInstance,this.telemetryManager,r.correlationId)]);case 4:return s.sent(),this.logger.verbose("Authority has been updated with endpoint discovery response"),[3,6];case 5:this.logger.verbose("Cached metadata found for authority"),s.label=6;case 6:return window.activeRenewals[o]?(this.logger.verbose("Renewing token in progress. Registering callback"),this.registerCallback(window.activeRenewals[o],o,e,n)):r.scopes&&r.scopes.indexOf(this.clientId)>-1&&1===r.scopes.length?(this.logger.verbose("ClientId is the only scope, renewing idToken"),this.silentLogin=!0,this.renewIdToken(o,e,n,i,l)):(this.logger.verbose("Renewing access token"),this.renewToken(o,e,n,i,l)),[3,8];case 7:return m=s.sent(),this.logger.error(m),n(G.createEndpointResolutionError(m.toString())),[2,null];case 8:return[2]}}))}))})).then((function(e){return t.logger.verbose("Successfully acquired token"),t.telemetryManager.stopAndFlushApiEvent(r.correlationId,n,!0),e})).catch((function(e){throw t.cacheStorage.resetTempCacheItems(r.state),t.telemetryManager.stopAndFlushApiEvent(r.correlationId,n,!1,e.errorCode),e}))},e.prototype.openPopup=function(e,t,r,n){this.logger.verbose("OpenPopup has been called");try{var i=window.screenLeft?window.screenLeft:window.screenX,a=window.screenTop?window.screenTop:window.screenY,s=window.innerWidth||document.documentElement.clientWidth||document.body.clientWidth,c=window.innerHeight||document.documentElement.clientHeight||document.body.clientHeight,u=s/2-r/2+i,l=c/2-n/2+a,h=window.open(e,t,"width="+r+", height="+n+", top="+l+", left="+u+", scrollbars=yes");if(!h)throw G.createPopupWindowError();return h.focus&&h.focus(),h}catch(e){throw this.cacheStorage.removeItem(o.INTERACTION_STATUS),G.createPopupWindowError(e.toString())}},e.prototype.loadIframeTimeout=function(e,t,r){return s.b(this,void 0,void 0,(function(){var n,i,a,c,l;return s.e(this,(function(s){switch(s.label){case 0:return n=window.activeRenewals[r],this.logger.verbosePii("Set loading state to pending for: "+r+":"+n),this.cacheStorage.setItem(Ee.generateTemporaryCacheKey(o.RENEW_STATUS,n),u.inProgress),this.config.system.navigateFrameWait?[4,Ce.loadFrame(e,t,this.config.system.navigateFrameWait,this.logger)]:[3,2];case 1:return a=s.sent(),[3,3];case 2:a=Ce.loadFrameSync(e,t,this.logger),s.label=3;case 3:i=a,s.label=4;case 4:return s.trys.push([4,6,,7]),[4,Ce.monitorIframeForHash(i.contentWindow,this.config.system.loadFrameTimeout,e,this.logger)];case 5:return(c=s.sent())&&this.handleAuthenticationResponse(c),[3,7];case 6:throw l=s.sent(),this.cacheStorage.getItem(Ee.generateTemporaryCacheKey(o.RENEW_STATUS,n))===u.inProgress&&(this.logger.verbose("Loading frame has timed out after: "+this.config.system.loadFrameTimeout/1e3+" seconds for scope/authority "+r+":"+n),n&&window.callbackMappedToRenewStates[n]&&window.callbackMappedToRenewStates[n](null,l),this.cacheStorage.removeItem(Ee.generateTemporaryCacheKey(o.RENEW_STATUS,n))),Ce.removeHiddenIframe(i),l;case 7:return Ce.removeHiddenIframe(i),[2]}}))}))},e.prototype.navigateWindow=function(e,t){if(!e||I.isEmpty(e))throw this.logger.info("Navigate url is empty"),b.createUnexpectedError("Navigate url is empty");var r=t||window,n=t?"Navigated Popup window to:"+e:"Navigate to:"+e;this.logger.infoPii(n),r.location.assign(e)},e.prototype.registerCallback=function(e,t,r,n){var o=this;window.activeRenewals[t]=e,window.promiseMappedToRenewStates[e]||(window.promiseMappedToRenewStates[e]=[]),window.promiseMappedToRenewStates[e].push({resolve:r,reject:n}),window.callbackMappedToRenewStates[e]||(window.callbackMappedToRenewStates[e]=function(r,n){window.activeRenewals[t]=null;for(var i=0;i<window.promiseMappedToRenewStates[e].length;++i)try{if(n)window.promiseMappedToRenewStates[e][i].reject(n);else{if(!r)throw o.cacheStorage.resetTempCacheItems(e),b.createUnexpectedError("Error and response are both null");window.promiseMappedToRenewStates[e][i].resolve(r)}}catch(e){o.logger.warning(e)}window.promiseMappedToRenewStates[e]=null,window.callbackMappedToRenewStates[e]=null})},e.prototype.logout=function(e){this.logger.verbose("Logout has been called"),this.logoutAsync(e)},e.prototype.logoutAsync=function(e){return s.b(this,void 0,void 0,(function(){var t,r,n,o,i,a;return s.e(this,(function(s){switch(s.label){case 0:t=e||c.createNewGuid(),r=this.telemetryManager.createAndStartApiEvent(t,Je.Logout),this.clearCache(),this.account=null,s.label=1;case 1:return s.trys.push([1,5,,6]),this.authorityInstance.hasCachedMetadata()?[3,3]:(this.logger.verbose("No cached metadata for authority"),[4,Pe.saveMetadataFromNetwork(this.authorityInstance,this.telemetryManager,e)]);case 2:return s.sent(),[3,4];case 3:this.logger.verbose("Cached metadata found for authority"),s.label=4;case 4:return n="client-request-id="+t,o=void 0,this.getPostLogoutRedirectUri()?(o="&post_logout_redirect_uri="+encodeURIComponent(this.getPostLogoutRedirectUri()),this.logger.verbose("redirectUri found and set")):(o="",this.logger.verbose("No redirectUri set for app. postLogoutQueryParam is empty")),i=void 0,this.authorityInstance.EndSessionEndpoint?(i=this.authorityInstance.EndSessionEndpoint+"?"+n+o,this.logger.verbose("EndSessionEndpoint found and urlNavigate set"),this.logger.verbosePii("urlNavigate set to: "+this.authorityInstance.EndSessionEndpoint)):(i=this.authority+"oauth2/v2.0/logout?"+n+o,this.logger.verbose("No endpoint, urlNavigate set to default")),this.telemetryManager.stopAndFlushApiEvent(t,r,!0),this.logger.verbose("Navigating window to urlNavigate"),this.navigateWindow(i),[3,6];case 5:return a=s.sent(),this.telemetryManager.stopAndFlushApiEvent(t,r,!1,a.errorCode),[3,6];case 6:return[2]}}))}))},e.prototype.clearCache=function(){this.logger.verbose("Clearing cache"),window.renewStates=[];for(var e=this.cacheStorage.getAllAccessTokens(u.clientId,u.homeAccountIdentifier),t=0;t<e.length;t++)this.cacheStorage.removeItem(JSON.stringify(e[t].key));this.cacheStorage.resetCacheItems(),this.cacheStorage.clearMsalCookie(),this.logger.verbose("Cache cleared")},e.prototype.clearCacheForScope=function(e){this.logger.verbose("Clearing access token from cache");for(var t=this.cacheStorage.getAllAccessTokens(u.clientId,u.homeAccountIdentifier),r=0;r<t.length;r++){var n=t[r];n.value.accessToken===e&&(this.cacheStorage.removeItem(JSON.stringify(n.key)),this.logger.verbosePii("Access token removed: "+n.key))}},e.prototype.isCallback=function(e){return this.logger.info("isCallback will be deprecated in favor of urlContainsHash in MSAL.js v2.0."),this.logger.verbose("isCallback has been called"),de.urlContainsHash(e)},e.prototype.processCallBack=function(e,t,r){var o,i;this.logger.info("ProcessCallBack has been called. Processing callback from redirect response"),t||(this.logger.verbose("StateInfo is null, getting stateInfo from hash"),t=this.getResponseState(e));try{o=this.saveTokenFromHash(e,t)}catch(e){i=e}try{this.cacheStorage.clearMsalCookie(t.state);var a=this.getAccountState(t.state);if(o){if(t.requestType===u.renewToken||o.accessToken?(window.parent!==window?this.logger.verbose("Window is in iframe, acquiring token silently"):this.logger.verbose("Acquiring token interactive in progress"),this.logger.verbose("Response tokenType set to "+n.ACCESS_TOKEN),o.tokenType=n.ACCESS_TOKEN):t.requestType===u.login&&(this.logger.verbose("Response tokenType set to "+n.ID_TOKEN),o.tokenType=n.ID_TOKEN),!r)return this.logger.verbose("Setting redirectResponse"),void(this.redirectResponse=o)}else if(!r)return this.logger.verbose("Response is null, setting redirectResponse with state"),this.redirectResponse=We(a),this.redirectError=i,void this.cacheStorage.resetTempCacheItems(t.state);this.logger.verbose("Calling callback provided to processCallback"),r(o,i)}catch(e){throw this.logger.error("Error occurred in token received callback function: "+e),G.createErrorInCallbackFunction(e.toString())}},e.prototype.handleAuthenticationResponse=function(e){this.logger.verbose("HandleAuthenticationResponse has been called");var t=e||window.location.hash,r=this.getResponseState(t);this.logger.verbose("Obtained state from response");var n=window.callbackMappedToRenewStates[r.state];this.processCallBack(t,r,n),Ce.closePopups()},e.prototype.handleRedirectAuthenticationResponse=function(e){this.logger.info("Returned from redirect url"),this.logger.verbose("HandleRedirectAuthenticationResponse has been called"),window.location.hash="",this.logger.verbose("Window.location.hash cleared");var t=this.getResponseState(e);if(this.config.auth.navigateToLoginRequestUrl&&window.parent===window){this.logger.verbose("Window.parent is equal to window, not in popup or iframe. Navigation to login request url after login turned on");var r=this.cacheStorage.getItem(Ee.generateTemporaryCacheKey(o.LOGIN_REQUEST,t.state),this.inCookie);if(!r||"null"===r)return this.logger.error("Unable to get valid login request url from cache, redirecting to home page"),void window.location.assign("/");this.logger.verbose("Valid login request url obtained from cache");var n=de.removeHashFromUrl(window.location.href),i=de.removeHashFromUrl(r);if(n!==i)return this.logger.verbose("Current url is not login request url, navigating"),this.logger.verbosePii("CurrentUrl: "+n+", finalRedirectUrl: "+i),void window.location.assign(""+i+e);this.logger.verbose("Current url matches login request url");var a=de.GetUrlComponents(r);a.Hash&&(this.logger.verbose("Login request url contains hash, resetting non-msal hash"),window.location.hash=a.Hash)}else this.config.auth.navigateToLoginRequestUrl||this.logger.verbose("Default navigation to start page after login turned off");this.processCallBack(e,t,null)},e.prototype.getResponseState=function(e){this.logger.verbose("GetResponseState has been called");var t,r=de.deserializeHash(e);if(!r)throw b.createUnexpectedError("Hash was not parsed correctly.");if(!r.hasOwnProperty(n.STATE))throw b.createUnexpectedError("Hash does not contain state.");this.logger.verbose("Hash contains state. Creating stateInfo object");var i=Te.parseLibraryState(r.state);if((t={requestType:u.unknown,state:r.state,timestamp:i.ts,method:i.method,stateMatch:!1}).state===this.cacheStorage.getItem(Ee.generateTemporaryCacheKey(o.STATE_LOGIN,t.state),this.inCookie)||t.state===this.silentAuthenticationState)return this.logger.verbose("State matches cached state, setting requestType to login"),t.requestType=u.login,t.stateMatch=!0,t;if(t.state===this.cacheStorage.getItem(Ee.generateTemporaryCacheKey(o.STATE_ACQ_TOKEN,t.state),this.inCookie))return this.logger.verbose("State matches cached state, setting requestType to renewToken"),t.requestType=u.renewToken,t.stateMatch=!0,t;if(!t.stateMatch){this.logger.verbose("State does not match cached state, setting requestType to type from window"),t.requestType=window.requestType;for(var a=window.renewStates,s=0;s<a.length;s++)if(a[s]===t.state){this.logger.verbose("Matching state found for request"),t.stateMatch=!0;break}t.stateMatch||this.logger.verbose("Matching state not found for request")}return t},e.prototype.getCachedToken=function(e,t){this.logger.verbose("GetCachedToken has been called");var r=null,o=e.scopes,i=this.cacheStorage.getAllAccessTokens(this.clientId,t?t.homeAccountIdentifier:null);if(this.logger.verbose("Getting all cached access tokens"),0===i.length)return this.logger.verbose("No matching tokens found when filtered by clientId and account"),null;var a=[];if(e.authority){this.logger.verbose("Authority passed, filtering by authority and scope");for(s=0;s<i.length;s++){u=(c=i[s]).key.scopes.split(" ");he.containsScope(u,o)&&de.CanonicalizeUri(c.key.authority)===e.authority&&a.push(c)}if(0===a.length)return this.logger.verbose("No matching tokens found"),null;if(1!==a.length)throw G.createMultipleMatchingTokensInCacheError(o.toString());this.logger.verbose("Single token found"),r=a[0]}else{this.logger.verbose("No authority passed, filtering tokens by scope");for(var s=0;s<i.length;s++){var c,u=(c=i[s]).key.scopes.split(" ");he.containsScope(u,o)&&a.push(c)}if(1===a.length)this.logger.verbose("One matching token found, setting authorityInstance"),r=a[0],e.authorityInstance=Pe.CreateInstance(r.key.authority,this.config.auth.validateAuthority);else{if(a.length>1)throw G.createMultipleMatchingTokensInCacheError(o.toString());this.logger.verbose("No matching token found when filtering by scope");var l=this.getUniqueAuthority(i,"authority");if(l.length>1)throw G.createMultipleAuthoritiesInCacheError(o.toString());this.logger.verbose("Single authority used, setting authorityInstance"),e.authorityInstance=Pe.CreateInstance(l[0],this.config.auth.validateAuthority)}}if(null!=r){this.logger.verbose("Evaluating access token found");var h=Number(r.value.expiresIn),d=this.config.system.tokenRenewalOffsetSeconds||300;if(h&&h>we.now()+d){this.logger.verbose("Token expiration is within offset, renewing token");var p=new ve(r.value.idToken);if(!t&&!(t=this.getAccount()))throw b.createUnexpectedError("Account should not be null here.");var g=this.getAccountState(e.state),f={uniqueId:"",tenantId:"",tokenType:r.value.idToken===r.value.accessToken?n.ID_TOKEN:n.ACCESS_TOKEN,idToken:p,idTokenClaims:p.claims,accessToken:r.value.accessToken,scopes:r.key.scopes.split(" "),expiresOn:new Date(1e3*h),account:t,accountState:g,fromCache:!0};return ke.setResponseIdToken(f,p),this.logger.verbose("Response generated and token set"),f}return this.logger.verbose("Token expired, removing from cache"),this.cacheStorage.removeItem(JSON.stringify(a[0].key)),null}return this.logger.verbose("No tokens found"),null},e.prototype.getUniqueAuthority=function(e,t){this.logger.verbose("GetUniqueAuthority has been called");var r=[],n=[];return e.forEach((function(e){e.key.hasOwnProperty(t)&&-1===n.indexOf(e.key[t])&&(n.push(e.key[t]),r.push(e.key[t]))})),r},e.prototype.extractADALIdToken=function(){this.logger.verbose("ExtractADALIdToken has been called");var e=this.cacheStorage.getItem(u.adalIdToken);return I.isEmpty(e)?null:ye.extractIdToken(e)},e.prototype.renewToken=function(e,t,r,n,o){this.logger.verbose("RenewToken has been called"),this.logger.verbosePii("RenewToken scope and authority: "+e);var i=Ce.generateFrameName(f,e);Ce.addHiddenIFrame(i,this.logger),this.updateCacheEntries(o,n,!1),this.logger.verbosePii("RenewToken expected state: "+o.state);var a=de.urlRemoveQueryStringParameter(de.createNavigateUrl(o),u.prompt)+u.prompt_none+u.response_mode_fragment;window.renewStates.push(o.state),window.requestType=u.renewToken,this.logger.verbose("Set window.renewState and requestType"),this.registerCallback(o.state,e,t,r),this.logger.infoPii("Navigate to: "+a),this.loadIframeTimeout(a,i,e).catch((function(e){return r(e)}))},e.prototype.renewIdToken=function(e,t,r,n,o){this.logger.info("RenewIdToken has been called");var i=Ce.generateFrameName(g,e);Ce.addHiddenIFrame(i,this.logger),this.updateCacheEntries(o,n,!1),this.logger.verbose("RenewIdToken expected state: "+o.state);var a=de.urlRemoveQueryStringParameter(de.createNavigateUrl(o),u.prompt)+u.prompt_none+u.response_mode_fragment;this.silentLogin?(this.logger.verbose("Silent login is true, set silentAuthenticationState"),window.requestType=u.login,this.silentAuthenticationState=o.state):(this.logger.verbose("Not silent login, set window.renewState and requestType"),window.requestType=u.renewToken,window.renewStates.push(o.state)),this.registerCallback(o.state,e,t,r),this.logger.infoPii('Navigate to:" '+a),this.loadIframeTimeout(a,i,e).catch((function(e){return r(e)}))},e.prototype.saveAccessToken=function(e,t,r,o,i){var a;this.logger.verbose("SaveAccessToken has been called");var c,u=s.a({},e),l=new me(o);if(r.hasOwnProperty(n.SCOPE)){this.logger.verbose("Response parameters contains scope");var h=(a=r[n.SCOPE]).split(" "),d=this.cacheStorage.getAllAccessTokens(this.clientId,t);this.logger.verbose("Retrieving all access tokens from cache and removing duplicates");for(var p=0;p<d.length;p++){var g=d[p];if(g.key.homeAccountIdentifier===e.account.homeAccountIdentifier){var f=g.key.scopes.split(" ");he.isIntersectingScopes(f,h)&&this.cacheStorage.removeItem(JSON.stringify(g.key))}}var m=we.parseExpiresIn(r[n.EXPIRES_IN]);c=Te.parseLibraryState(r[n.STATE]).ts+m;var y=new pe(t,this.clientId,a,l.uid,l.utid),v=new ge(r[n.ACCESS_TOKEN],i.rawIdToken,c.toString(),o);this.cacheStorage.setItem(JSON.stringify(y),JSON.stringify(v)),this.logger.verbose("Saving token to cache"),u.accessToken=r[n.ACCESS_TOKEN],u.scopes=h}else{this.logger.verbose("Response parameters does not contain scope, clientId set as scope"),a=this.clientId;y=new pe(t,this.clientId,a,l.uid,l.utid);c=Number(i.expiration);v=new ge(r[n.ID_TOKEN],r[n.ID_TOKEN],c.toString(),o);this.cacheStorage.setItem(JSON.stringify(y),JSON.stringify(v)),this.logger.verbose("Saving token to cache"),u.scopes=[a],u.accessToken=r[n.ID_TOKEN]}return c?(this.logger.verbose("New expiration set"),u.expiresOn=new Date(1e3*c)):this.logger.error("Could not parse expiresIn parameter"),u},e.prototype.saveTokenFromHash=function(e,t){this.logger.verbose("SaveTokenFromHash has been called"),this.logger.info("State status: "+t.stateMatch+"; Request type: "+t.requestType);var r,s={uniqueId:"",tenantId:"",tokenType:"",idToken:null,idTokenClaims:null,accessToken:null,scopes:[],expiresOn:null,account:null,accountState:"",fromCache:!1},c=de.deserializeHash(e),l="",h="",d=null;if(c.hasOwnProperty(n.ERROR_DESCRIPTION)||c.hasOwnProperty(n.ERROR)){if(this.logger.verbose("Server returned an error"),this.logger.infoPii("Error : "+c[n.ERROR]+"; Error description: "+c[n.ERROR_DESCRIPTION]),this.cacheStorage.setItem(a.ERROR,c[n.ERROR]),this.cacheStorage.setItem(a.ERROR_DESC,c[n.ERROR_DESCRIPTION]),t.requestType===u.login&&(this.logger.verbose("RequestType is login, caching login error, generating authorityKey"),this.cacheStorage.setItem(a.LOGIN_ERROR,c[n.ERROR_DESCRIPTION]+":"+c[n.ERROR]),l=Ee.generateAuthorityKey(t.state)),t.requestType===u.renewToken){this.logger.verbose("RequestType is renewToken, generating acquireTokenAccountKey"),l=Ee.generateAuthorityKey(t.state);var p=this.getAccount(),g=void 0;p&&!I.isEmpty(p.homeAccountIdentifier)?(g=p.homeAccountIdentifier,this.logger.verbose("AccountId is set")):(g=u.no_account,this.logger.verbose("AccountId is set as no_account")),h=Ee.generateAcquireTokenAccountKey(g,t.state)}var f=c[n.ERROR],m=c[n.ERROR_DESCRIPTION];r=Ge.isInteractionRequiredError(f)||Ge.isInteractionRequiredError(m)?new Ge(c[n.ERROR],c[n.ERROR_DESCRIPTION]):new je(c[n.ERROR],c[n.ERROR_DESCRIPTION])}else if(this.logger.verbose("Server returns success"),t.stateMatch){this.logger.info("State is right"),c.hasOwnProperty(n.SESSION_STATE)&&(this.logger.verbose("Fragment has session state, caching"),this.cacheStorage.setItem(Ee.generateTemporaryCacheKey(o.SESSION_STATE,t.state),c[n.SESSION_STATE])),s.accountState=this.getAccountState(t.state);var y="";if(c.hasOwnProperty(n.ACCESS_TOKEN)){this.logger.info("Fragment has access token"),s.accessToken=c[n.ACCESS_TOKEN],c.hasOwnProperty(n.SCOPE)&&(s.scopes=c[n.SCOPE].split(" ")),c.hasOwnProperty(n.ID_TOKEN)?(this.logger.verbose("Fragment has id_token"),d=new ve(c[n.ID_TOKEN]),s.idToken=d,s.idTokenClaims=d.claims):(this.logger.verbose("No idToken on fragment, getting idToken from cache"),d=new ve(this.cacheStorage.getItem(i.IDTOKEN)),s=ke.setResponseIdToken(s,d));var v=this.populateAuthority(t.state,this.inCookie,this.cacheStorage,d);if(this.logger.verbose("Got authority from cache"),!c.hasOwnProperty(n.CLIENT_INFO))throw this.logger.warning("ClientInfo not received in the response from AAD"),G.createClientInfoNotPopulatedError("ClientInfo not received in the response from the server");this.logger.verbose("Fragment has clientInfo"),y=c[n.CLIENT_INFO],s.account=Se.createAccount(d,new me(y)),this.logger.verbose("Account object created from response");var w=void 0;s.account&&!I.isEmpty(s.account.homeAccountIdentifier)?(this.logger.verbose("AccountKey set"),w=s.account.homeAccountIdentifier):(this.logger.verbose("AccountKey set as no_account"),w=u.no_account),h=Ee.generateAcquireTokenAccountKey(w,t.state);var T=Ee.generateAcquireTokenAccountKey(u.no_account,t.state);this.logger.verbose("AcquireTokenAccountKey generated");var E=this.cacheStorage.getItem(h),S=void 0;I.isEmpty(E)?I.isEmpty(this.cacheStorage.getItem(T))||(this.logger.verbose("No acquireToken account retrieved from cache"),s=this.saveAccessToken(s,v,c,y,d)):(S=JSON.parse(E),this.logger.verbose("AcquireToken request account retrieved from cache"),s.account&&S&&Se.compareAccounts(s.account,S)?(s=this.saveAccessToken(s,v,c,y,d),this.logger.info("The user object received in the response is the same as the one passed in the acquireToken request")):this.logger.warning("The account object created from the response is not the same as the one passed in the acquireToken request"))}if(c.hasOwnProperty(n.ID_TOKEN)){this.logger.info("Fragment has idToken"),d=new ve(c[n.ID_TOKEN]),s=ke.setResponseIdToken(s,d),c.hasOwnProperty(n.CLIENT_INFO)?(this.logger.verbose("Fragment has clientInfo"),y=c[n.CLIENT_INFO]):this.logger.warning("ClientInfo not received in the response from AAD");v=this.populateAuthority(t.state,this.inCookie,this.cacheStorage,d);if(this.account=Se.createAccount(d,new me(y)),s.account=this.account,this.logger.verbose("Account object created from response"),d&&d.nonce){this.logger.verbose("IdToken has nonce");var C=this.cacheStorage.getItem(Ee.generateTemporaryCacheKey(o.NONCE_IDTOKEN,t.state),this.inCookie);d.nonce!==C?(this.account=null,this.cacheStorage.setItem(a.LOGIN_ERROR,"Nonce Mismatch. Expected Nonce: "+C+",Actual Nonce: "+d.nonce),this.logger.error("Nonce Mismatch. Expected Nonce: "+C+", Actual Nonce: "+d.nonce),r=G.createNonceMismatchError(C,d.nonce)):(this.logger.verbose("Nonce matches, saving idToken to cache"),this.cacheStorage.setItem(i.IDTOKEN,c[n.ID_TOKEN],this.inCookie),this.cacheStorage.setItem(i.CLIENT_INFO,y,this.inCookie),this.saveAccessToken(s,v,c,y,d))}else this.logger.verbose("No idToken or no nonce. Cache key for Authority set as state"),l=t.state,h=t.state,this.logger.error("Invalid id_token received in the response"),r=G.createInvalidIdTokenError(d),this.cacheStorage.setItem(a.ERROR,r.errorCode),this.cacheStorage.setItem(a.ERROR_DESC,r.errorMessage)}}else{this.logger.verbose("State mismatch"),l=t.state,h=t.state;var k=this.cacheStorage.getItem(Ee.generateTemporaryCacheKey(o.STATE_LOGIN,t.state),this.inCookie);this.logger.error("State Mismatch. Expected State: "+k+", Actual State: "+t.state),r=G.createInvalidStateError(t.state,k),this.cacheStorage.setItem(a.ERROR,r.errorCode),this.cacheStorage.setItem(a.ERROR_DESC,r.errorMessage)}if(this.cacheStorage.removeItem(Ee.generateTemporaryCacheKey(o.RENEW_STATUS,t.state)),this.cacheStorage.resetTempCacheItems(t.state),this.logger.verbose("Status set to complete, temporary cache cleared"),this.inCookie&&(this.logger.verbose("InCookie is true, setting authorityKey in cookie"),this.cacheStorage.setItemCookie(l,"",-1),this.cacheStorage.clearMsalCookie(t.state)),r)throw r;if(!s)throw b.createUnexpectedError("Response is null");return s},e.prototype.populateAuthority=function(e,t,r,n){this.logger.verbose("PopulateAuthority has been called");var o=Ee.generateAuthorityKey(e),i=r.getItem(o,t);return I.isEmpty(i)?i:de.replaceTenantPath(i,n.tenantId)},e.prototype.getAccount=function(){if(this.account)return this.account;var e=this.cacheStorage.getItem(i.IDTOKEN,this.inCookie),t=this.cacheStorage.getItem(i.CLIENT_INFO,this.inCookie);if(!I.isEmpty(e)&&!I.isEmpty(t)){var r=new ve(e),n=new me(t);return this.account=Se.createAccount(r,n),this.account}return null},e.prototype.getAccountState=function(e){if(e){var t=e.indexOf(u.resourceDelimiter);if(t>-1&&t+1<e.length)return e.substring(t+1)}return e},e.prototype.getAllAccounts=function(){for(var e=[],t=this.cacheStorage.getAllAccessTokens(u.clientId,u.homeAccountIdentifier),r=0;r<t.length;r++){var n=new ve(t[r].value.idToken),o=new me(t[r].value.homeAccountIdentifier),i=Se.createAccount(n,o);e.push(i)}return this.getUniqueAccounts(e)},e.prototype.getUniqueAccounts=function(e){if(!e||e.length<=1)return e;for(var t=[],r=[],n=0;n<e.length;++n)e[n].homeAccountIdentifier&&-1===t.indexOf(e[n].homeAccountIdentifier)&&(t.push(e[n].homeAccountIdentifier),r.push(e[n]));return r},e.prototype.broadcast=function(e,t){var r=new CustomEvent(e,{detail:t});window.dispatchEvent(r)},e.prototype.getCachedTokenInternal=function(e,t,r,n){var o=t||this.getAccount();if(!o)return null;var i=this.authorityInstance?this.authorityInstance:Pe.CreateInstance(this.authority,this.config.auth.validateAuthority),a=this.getTokenType(o,e,!0),s=new fe(i,this.clientId,a,this.getRedirectUri(),e,r,n);return this.getCachedToken(s,t)},e.prototype.getScopesForEndpoint=function(e){if(this.config.framework.unprotectedResources.length>0)for(var t=0;t<this.config.framework.unprotectedResources.length;t++)if(e.indexOf(this.config.framework.unprotectedResources[t])>-1)return null;if(this.config.framework.protectedResourceMap.size>0)for(var r=0,n=Array.from(this.config.framework.protectedResourceMap.keys());r<n.length;r++){var o=n[r];if(e.indexOf(o)>-1)return this.config.framework.protectedResourceMap.get(o)}return e.indexOf("http://")>-1||e.indexOf("https://")>-1?de.getHostFromUri(e)===de.getHostFromUri(this.getRedirectUri())?new Array(this.clientId):null:new Array(this.clientId)},e.prototype.getLoginInProgress=function(){return this.cacheStorage.getItem(o.INTERACTION_STATUS)===u.inProgress},e.prototype.setInteractionInProgress=function(e){e?this.cacheStorage.setItem(o.INTERACTION_STATUS,u.inProgress):this.cacheStorage.removeItem(o.INTERACTION_STATUS)},e.prototype.setloginInProgress=function(e){this.setInteractionInProgress(e)},e.prototype.getAcquireTokenInProgress=function(){return this.cacheStorage.getItem(o.INTERACTION_STATUS)===u.inProgress},e.prototype.setAcquireTokenInProgress=function(e){this.setInteractionInProgress(e)},e.prototype.getLogger=function(){return this.logger},e.prototype.setLogger=function(e){this.logger=e},e.prototype.getRedirectUri=function(e){return e||("function"==typeof this.config.auth.redirectUri?this.config.auth.redirectUri():this.config.auth.redirectUri)},e.prototype.getPostLogoutRedirectUri=function(){return"function"==typeof this.config.auth.postLogoutRedirectUri?this.config.auth.postLogoutRedirectUri():this.config.auth.postLogoutRedirectUri},e.prototype.getCurrentConfiguration=function(){if(!this.config)throw le.createNoSetConfigurationError();return this.config},e.prototype.getTokenType=function(e,t,r){return r?Se.compareAccounts(e,this.getAccount())?t.indexOf(this.config.auth.clientId)>-1?_t:Pt:t.indexOf(this.config.auth.clientId)>-1?_t:Nt:Se.compareAccounts(e,this.getAccount())?t.indexOf(this.clientId)>-1?_t:Pt:Nt},e.prototype.setAccountCache=function(e,t){var r=e?this.getAccountId(e):u.no_account,n=Ee.generateAcquireTokenAccountKey(r,t);this.cacheStorage.setItem(n,JSON.stringify(e))},e.prototype.setAuthorityCache=function(e,t){var r=Ee.generateAuthorityKey(e);this.cacheStorage.setItem(r,de.CanonicalizeUri(t),this.inCookie)},e.prototype.updateCacheEntries=function(e,t,r,n){n&&this.cacheStorage.setItem(Ee.generateTemporaryCacheKey(o.LOGIN_REQUEST,e.state),n,this.inCookie),r?this.cacheStorage.setItem(Ee.generateTemporaryCacheKey(o.STATE_LOGIN,e.state),e.state,this.inCookie):this.setAccountCache(t,e.state),this.setAuthorityCache(e.state,e.authority),this.cacheStorage.setItem(Ee.generateTemporaryCacheKey(o.NONCE_IDTOKEN,e.state),e.nonce,this.inCookie)},e.prototype.getAccountId=function(e){return I.isEmpty(e.homeAccountIdentifier)?u.no_account:e.homeAccountIdentifier},e.prototype.buildIDTokenRequest=function(e){return{scopes:[this.clientId],authority:this.authority,account:this.getAccount(),extraQueryParameters:e.extraQueryParameters,correlationId:e.correlationId}},e.prototype.getTelemetryManagerFromConfig=function(e,t){if(!e)return Ot.getTelemetrymanagerStub(t,this.logger);var r=e.applicationName,n=e.applicationVersion,o=e.telemetryEmitter;if(!r||!n||!o)throw le.createTelemetryConfigError(e);return new Ot({platform:{applicationName:r,applicationVersion:n},clientId:t},o,this.logger)},e}()}});
//# sourceMappingURL=login.841a42284a3e24567cf7.js.map